!function(){/**
 * @license almond 0.3.0 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
var t,e,n;!function(r){function i(t,e){return b.call(t,e)}function s(t,e){var n,r,i,s,o,a,u,l,h,c,p,f=e&&e.split("/"),d=v.map,g=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(f=f.slice(0,f.length-1),t=t.split("/"),o=t.length-1,v.nodeIdCompat&&k.test(t[o])&&(t[o]=t[o].replace(k,"")),t=f.concat(t),h=0;h<t.length;h+=1)if(p=t[h],"."===p)t.splice(h,1),h-=1;else if(".."===p){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||g)&&d){for(n=t.split("/"),h=n.length;h>0;h-=1){if(r=n.slice(0,h).join("/"),f)for(c=f.length;c>0;c-=1)if(i=d[f.slice(0,c).join("/")],i&&(i=i[r])){s=i,a=h;break}if(s)break;!u&&g&&g[r]&&(u=g[r],l=h)}!s&&u&&(s=u,a=l),s&&(n.splice(0,a,s),t=n.join("/"))}return t}function o(t,e){return function(){var n=w.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),f.apply(r,n.concat([t,e]))}}function a(t){return function(e){return s(e,t)}}function u(t){return function(e){y[t]=e}}function l(t){if(i(m,t)){var e=m[t];delete m[t],_[t]=!0,p.apply(r,e)}if(!i(y,t)&&!i(_,t))throw new Error("No "+t);return y[t]}function h(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function c(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,f,d,g,y={},m={},v={},_={},b=Object.prototype.hasOwnProperty,w=[].slice,k=/\.js$/;d=function(t,e){var n,r=h(t),i=r[0];return t=r[1],i&&(i=s(i,e),n=l(i)),i?t=n&&n.normalize?n.normalize(t,a(e)):s(t,e):(t=s(t,e),r=h(t),i=r[0],t=r[1],i&&(n=l(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:n}},g={require:function(t){return o(t)},exports:function(t){var e=y[t];return"undefined"!=typeof e?e:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:c(t)}}},p=function(t,e,n,s){var a,h,c,p,f,v,b=[],w=typeof n;if(s=s||t,"undefined"===w||"function"===w){for(e=!e.length&&n.length?["require","exports","module"]:e,f=0;f<e.length;f+=1)if(p=d(e[f],s),h=p.f,"require"===h)b[f]=g.require(t);else if("exports"===h)b[f]=g.exports(t),v=!0;else if("module"===h)a=b[f]=g.module(t);else if(i(y,h)||i(m,h)||i(_,h))b[f]=l(h);else{if(!p.p)throw new Error(t+" missing "+h);p.p.load(p.n,o(s,!0),u(h),{}),b[f]=y[h]}c=n?n.apply(y[t],b):void 0,t&&(a&&a.exports!==r&&a.exports!==y[t]?y[t]=a.exports:c===r&&v||(y[t]=c))}else t&&(y[t]=n)},t=e=f=function(t,e,n,i,s){if("string"==typeof t)return g[t]?g[t](e):l(d(t,e).f);if(!t.splice){if(v=t,v.deps&&f(v.deps,v.callback),!e)return;e.splice?(t=e,e=n,n=null):t=r}return e=e||function(){},"function"==typeof n&&(n=i,i=s),i?p(r,t,e,n):setTimeout(function(){p(r,t,e,n)},4),f},f.config=function(t){return f(t)},t._defined=y,n=function(t,e,n){e.splice||(n=e,e=[]),i(y,t)||i(m,t)||(m[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("poly/lib/_base",["require","exports","module"],function(t,e){var n;n={}.toString,e.isFunction=function(t){return"function"==typeof t},e.isString=function(t){return"[object String]"==n.call(t)},e.toString=function(t){return n.apply(t)},e.createCaster=function(t,e){return function(n){if(null==n)throw new TypeError(e+" method called on null or undefined");return t(n)}}}),n("poly/function",["./lib/_base"],function(t){function e(e){var n=r[e];return t.isFunction(s[n])}var n,r,i=[].slice,s=Function.prototype;return r={"function-bind":"bind"},e("function-bind")||(n=function(t){var e=i.call(arguments,1),n=this,r=function(){},s=function(){return n.apply(this instanceof r?this:t||{},e.concat(i.call(arguments)))};return r.prototype=this.prototype||{},s.prototype=new r,s},s.bind=n),{}}),function(){function t(t){var e,n,r,o='{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',u="json"==t;if(u||"json-stringify"==t||"json-parse"==t){if("json-stringify"==t||u){if(e="function"==typeof a.stringify&&S){(r=function(){return 1}).toJSON=r;try{e="0"===a.stringify(0)&&"0"===a.stringify(new Number)&&'""'==a.stringify(new String)&&a.stringify(s)===i&&a.stringify(i)===i&&a.stringify()===i&&"1"===a.stringify(r)&&"[1]"==a.stringify([r])&&"[null]"==a.stringify([i])&&"null"==a.stringify(null)&&"[null,null,null]"==a.stringify([i,s,null])&&a.stringify({A:[r,!0,!1,null,"\x00\b\n\f\r	"]})==o&&"1"===a.stringify(null,r)&&"[\n 1,\n 2\n]"==a.stringify([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==a.stringify(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==a.stringify(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==a.stringify(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==a.stringify(new Date(-1))}catch(l){e=!1}}if(!u)return e}if("json-parse"==t||u){if("function"==typeof a.parse)try{if(0===a.parse("0")&&!a.parse(!1)&&(r=a.parse(o),n=5==r.A.length&&1==r.A[0])){try{n=!a.parse('"	"')}catch(l){}if(n)try{n=1!=a.parse("01")}catch(l){}}}catch(l){n=!1}if(!u)return n}return e&&n}}var e,r,i,s={}.toString,o="function"==typeof n&&n.amd,a=!o&&"object"==typeof exports&&exports;a||o?"object"==typeof JSON&&JSON?o?a=JSON:(a.stringify=JSON.stringify,a.parse=JSON.parse):o&&(a=this.JSON={}):a=this.JSON||(this.JSON={});var u,l,h,c,p,f,d,g,y,m,v,_,b,w,k,x,S=new Date(-0xc782b5b800cec);try{S=-109252==S.getUTCFullYear()&&0===S.getUTCMonth()&&1==S.getUTCDate()&&10==S.getUTCHours()&&37==S.getUTCMinutes()&&6==S.getUTCSeconds()&&708==S.getUTCMilliseconds()}catch(E){}t("json")||(S||(w=Math.floor,k=[0,31,59,90,120,151,181,212,243,273,304,334],x=function(t,e){return k[e]+365*(t-1970)+w((t-1969+(e=+(e>1)))/4)-w((t-1901+e)/100)+w((t-1601+e)/400)}),(e={}.hasOwnProperty)||(e=function(t){var n,r={};return(r.__proto__=null,r.__proto__={toString:1},r).toString!=s?e=function(t){var e=this.__proto__,n=t in(this.__proto__=null,this);return this.__proto__=e,n}:(n=r.constructor,e=function(t){var e=(this.constructor||n).prototype;return t in this&&!(t in e&&this[t]===e[t])}),r=null,e.call(this,t)}),r=function(t,n){var r,i,o,a,u=0;(r=function(){this.valueOf=0}).prototype.valueOf=0,i=new r;for(o in i)e.call(i,o)&&u++;return r=i=null,u?a=2==u?function(t,n){var r,i={},o="[object Function]"==s.call(t);for(r in t)o&&"prototype"==r||e.call(i,r)||!(i[r]=1)||!e.call(t,r)||n(r)}:function(t,n){var r,i,o="[object Function]"==s.call(t);for(r in t)o&&"prototype"==r||!e.call(t,r)||(i="constructor"===r)||n(r);(i||e.call(t,r="constructor"))&&n(r)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],a=function(t,n){var r,o,a="[object Function]"==s.call(t);for(r in t)a&&"prototype"==r||!e.call(t,r)||n(r);for(o=i.length;r=i[--o];e.call(t,r)&&n(r));}),a(t,n)},t("json-stringify")||(u={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},l=function(t,e){return("000000"+(e||0)).slice(-t)},h=function(t){for(var e,n='"',r=0;e=t.charAt(r);r++)n+='\\"\b\f\n\r	'.indexOf(e)>-1?u[e]:u[e]=" ">e?"\\u00"+l(2,e.charCodeAt(0).toString(16)):e;return n+'"'},c=function(t,n,o,a,u,p,f){var d,g,y,m,v,_,b,k,S,E,C,T,P,N,A,O,j=n[t];if("object"==typeof j&&j)if(d=s.call(j),"[object Date]"!=d||e.call(j,"toJSON"))"function"==typeof j.toJSON&&("[object Number]"!=d&&"[object String]"!=d&&"[object Array]"!=d||e.call(j,"toJSON"))&&(j=j.toJSON(t));else if(j>-1/0&&1/0>j){if(x){for(m=w(j/864e5),g=w(m/365.2425)+1970-1;x(g+1,0)<=m;g++);for(y=w((m-x(g,0))/30.42);x(g,y+1)<=m;y++);m=1+m-x(g,y),v=(j%864e5+864e5)%864e5,_=w(v/36e5)%24,b=w(v/6e4)%60,k=w(v/1e3)%60,S=v%1e3}else g=j.getUTCFullYear(),y=j.getUTCMonth(),m=j.getUTCDate(),_=j.getUTCHours(),b=j.getUTCMinutes(),k=j.getUTCSeconds(),S=j.getUTCMilliseconds();j=(0>=g||g>=1e4?(0>g?"-":"+")+l(6,0>g?-g:g):l(4,g))+"-"+l(2,y+1)+"-"+l(2,m)+"T"+l(2,_)+":"+l(2,b)+":"+l(2,k)+"."+l(3,S)+"Z"}else j=null;if(o&&(j=o.call(n,t,j)),null===j)return"null";if(d=s.call(j),"[object Boolean]"==d)return""+j;if("[object Number]"==d)return j>-1/0&&1/0>j?""+j:"null";if("[object String]"==d)return h(j);if("object"==typeof j){for(P=f.length;P--;)if(f[P]===j)throw TypeError();if(f.push(j),E=[],N=p,p+=u,"[object Array]"==d){for(T=0,P=j.length;P>T;A||(A=!0),T++)C=c(T,j,o,a,u,p,f),E.push(C===i?"null":C);O=A?u?"[\n"+p+E.join(",\n"+p)+"\n"+N+"]":"["+E.join(",")+"]":"[]"}else r(a||j,function(t){var e=c(t,j,o,a,u,p,f);e!==i&&E.push(h(t)+":"+(u?" ":"")+e),A||(A=!0)}),O=A?u?"{\n"+p+E.join(",\n"+p)+"\n"+N+"}":"{"+E.join(",")+"}":"{}";return f.pop(),O}},a.stringify=function(t,e,n){var r,i,o,a,u,l;if("function"==typeof e||"object"==typeof e&&e)if("[object Function]"==s.call(e))i=e;else if("[object Array]"==s.call(e))for(o={},a=0,u=e.length;u>a;l=e[a++],("[object String]"==s.call(l)||"[object Number]"==s.call(l))&&(o[l]=1));if(n)if("[object Number]"==s.call(n)){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else"[object String]"==s.call(n)&&(r=n.length<=10?n:n.slice(0,10));return c("",(l={},l[""]=t,l),i,o,r,"",[])}),t("json-parse")||(p=String.fromCharCode,f={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"	",n:"\n",f:"\f",r:"\r"},d=function(){throw _=b=null,SyntaxError()},g=function(){for(var t,e,n,r,i,s=b,o=s.length;o>_;)if(t=s.charAt(_),"	\r\n ".indexOf(t)>-1)_++;else{if("{}[]:,".indexOf(t)>-1)return _++,t;if('"'==t){for(e="@",_++;o>_;)if(t=s.charAt(_)," ">t)d();else if("\\"==t)if(t=s.charAt(++_),'\\"/btnfr'.indexOf(t)>-1)e+=f[t],_++;else if("u"==t){for(n=++_,r=_+4;r>_;_++)t=s.charAt(_),t>="0"&&"9">=t||t>="a"&&"f">=t||t>="A"&&"F">=t||d();e+=p("0x"+s.slice(n,_))}else d();else{if('"'==t)break;e+=t,_++}if('"'==s.charAt(_))return _++,e;d()}else{if(n=_,"-"==t&&(i=!0,t=s.charAt(++_)),t>="0"&&"9">=t){for("0"==t&&(t=s.charAt(_+1),t>="0"&&"9">=t)&&d(),i=!1;o>_&&(t=s.charAt(_),t>="0"&&"9">=t);_++);if("."==s.charAt(_)){for(r=++_;o>r&&(t=s.charAt(r),t>="0"&&"9">=t);r++);r==_&&d(),_=r}if(t=s.charAt(_),"e"==t||"E"==t){for(t=s.charAt(++_),("+"==t||"-"==t)&&_++,r=_;o>r&&(t=s.charAt(r),t>="0"&&"9">=t);r++);r==_&&d(),_=r}return+s.slice(n,_)}if(i&&d(),"true"==s.slice(_,_+4))return _+=4,!0;if("false"==s.slice(_,_+5))return _+=5,!1;if("null"==s.slice(_,_+4))return _+=4,null;d()}}return"$"},y=function(t){var e,n;if("$"==t&&d(),"string"==typeof t){if("@"==t.charAt(0))return t.slice(1);if("["==t){for(e=[];t=g(),"]"!=t;n||(n=!0))n&&(","==t?(t=g(),"]"==t&&d()):d()),","==t&&d(),e.push(y(t));return e}if("{"==t){for(e={};t=g(),"}"!=t;n||(n=!0))n&&(","==t?(t=g(),"}"==t&&d()):d()),(","==t||"string"!=typeof t||"@"!=t.charAt(0)||":"!=g())&&d(),e[t.slice(1)]=y(g());return e}d()}return t},v=function(t,e,n){var r=m(t,e,n);r===i?delete t[e]:t[e]=r},m=function(t,e,n){var i,o=t[e];if("object"==typeof o&&o)if("[object Array]"==s.call(o))for(i=o.length;i--;)v(o,i,n);else r(o,function(t){v(o,t,n)});return n.call(t,e,o)},a.parse=function(t,e){var n,r;return _=0,b=t,n=y(g()),"$"!=g()&&d(),_=b=null,e&&"[object Function]"==s.call(e)?m((r={},r[""]=n,r),"",e):n})),o&&n("poly/support/json3",[],function(){return a})}.call(this),n("poly/json",["./support/json3"],function(t){return t}),n("poly/array",["./lib/_base"],function(t){function e(e){return"[object String]"==t.toString(e)?e.split(""):u(e)}function n(t){return"[object Array]"==f.call(t)}function r(e){var n=a[e];return t.isFunction(p[n])}function i(){return 1}function s(t){return t}function o(n,r,i,s,o,a){var u,l,h,p;if(u=e(n),l=u.length>>>0,o===c&&(o=0),a||(a=1),p=0>a?-1:l,!t.isFunction(r))throw new TypeError(r+" is not a function");if(o==p)return!1;if(p>=o^a>0)throw new TypeError("Invalid length or starting index");for(h=o;h!=p;h+=a)if(h in u&&!i(r.call(s,u[h],h,u),h,u[h]))return!1;return!0}var a,u,l,h,c,p=Array.prototype,f={}.toString;a={"array-foreach":"forEach","array-every":"every","array-some":"some","array-map":"map","array-filter":"filter","array-reduce":"reduce","array-reduceright":"reduceRight","array-indexof":"indexOf","array-lastindexof":"lastIndexOf"},u=t.createCaster(Object,"Array"),r("array-foreach")||(p.forEach=function(t){o(this,t,i,arguments[1])}),r("array-every")||(p.every=function(t){return o(this,t,s,arguments[1])}),r("array-some")||(p.some=function(t){return o(this,t,function(t){return!t},arguments[1])}),r("array-map")||(p.map=function(t){var e,n;return e=this,n=new Array(e.length),o(e,t,function(t,e){return n[e]=t,1},arguments[1]),n}),r("array-filter")||(p.filter=function(t){var e,n;return e=this,n=[],o(e,t,function(t,e,r){return t&&n.push(r),1},arguments[1]),n}),r("array-reduce")&&r("array-reduceright")||(l=function(t,n,r,a){var u,l,h;if(l=h=n>0?-1:e(this).length>>>0,a)u=r;else if(o(this,s,function(t,e){u=t,h=e},null,l+n,n),h==l)throw new TypeError;return o(this,function(e,n,r){u=t(u,e,n,r)},i,null,h+n,n),u},r("array-reduce")||(p.reduce=function(t){return l.call(this,t,1,arguments[1],arguments.length>1)}),r("array-reduceright")||(p.reduceRight=function(t){return l.call(this,t,-1,arguments[1],arguments.length>1)})),r("array-indexof")&&r("array-lastindexof")||(h=function(t,n,r,i){var a=e(t).length>>>0,u=-1;return r=isNaN(r)?i?0:a-1:Number(r),0>r&&(r=a+r-1),o(t,s,function(t,e){return t===n&&(u=e),-1==u},null,r,i?1:-1),u},r("array-indexof")||(p.indexOf=function(t){return h(this,t,arguments[1],!0)}),r("array-lastindexof")||(p.lastIndexOf=function(t){return h(this,t,arguments[1],!1)})),Array.isArray||(Array.isArray=n)}),n("poly/string",["./lib/_base"],function(t){function e(e){var n=s[e];return t.isFunction(u[n])}function n(){return!1}function r(t,e){return t.replace(e,"")}function i(){o("string-trim")||(u.trim=function(){return r(r(a(this),h),l)}),o("string-trimleft")||(u.trimLeft=function(){return r(a(this),h)}),o("string-trimright")||(u.trimRight=function(){return r(a(this),l)})}var s,o,a,u=String.prototype;s={"string-trim":"trim","string-trimleft":"trimLeft","string-trimright":"trimRight"},o=e,a=t.createCaster(String,"String");var l,h;return l=/\s+$/,h=/^\s+/,i(),{setWhitespaceChars:function(t){l=new RegExp(t+"$"),h=new RegExp("^"+t),o=n,i()}}}),function(t){n("poly/date",["./lib/_base"],function(e){function n(e){var n=h[e];return n in t||n in u}function r(t){return!isFinite(t)}function i(t){return(10>t?"0":"")+t}function s(t){var e;return e=p,t.replace(d,function(t,n,r,i,s,o,a,u,l,h,f){var d=0;return n>=0&&100>n&&(n=+n+400,d=-126227808e5),e=Date.UTC(n,(r||1)-1,i||1,s||0,o||0,a||0,u||0)+d,h=+(l+h),f=+(l+f),(h||f)&&(e-=36e5*(h+f/60),(h>23||-23>h||f>59)&&(e=p),e>c&&(e=p)),""}),e}function o(){var n=function(){return function(r,i,s,o,a,u,l){var h,c;return this instanceof n?(h=arguments.length,c=0===h?new t:1===h?new t(e.isString(r)?n.parse(r):r):new t(r,i,s==y?1:s,o||0,a||0,u||0,l||0),c.constructor=n,c):t.apply(this,arguments)}}();f()?Date!=t&&(Date=t):(n.now=t.now,n.UTC=t.UTC,n.prototype=u,n.prototype.constructor=n,n.parse=function(t){var e;return e=s(""+t),r(e)&&(e=l(t)),e},a(n,t),Date=n)}function a(t,e){for(var n in e)g.call(e,n)&&!g.call(t,n)&&(t[n]=e[n])}var u,l,h,c,p,f,d,g,y;return u=t.prototype,l=t.parse,g=Object.prototype.hasOwnProperty,c=864e13,p=0/0,f=function(){return t.parse("+275760-09-13T00:00:00.000Z")==c},d=/^([+\-]\d{6}|\d{4})(?:-(\d{2}))?(?:-(\d{2}))?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:.(\d{1,3}))?)?(?:Z|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,h={"date-now":"now","date-tojson":"toJSON","date-toisostring":"toISOString"},n("date-now")||(t.now=function(){return+new Date}),n("date-toisostring")||(u.toISOString=function(){if(r(this))throw new RangeError("toISOString called on invalid value");return[this.getUTCFullYear(),"-",i(this.getUTCMonth()+1),"-",i(this.getUTCDate()),"T",i(this.getUTCHours()),":",i(this.getUTCMinutes()),":",i(this.getUTCSeconds()),".",(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2),"Z"].join("")}),n("date-tojson")||(u.toJSON=function(){return this.toISOString()}),o(),{setIsoCompatTest:function(t){f=t,o()}}})}(Date),/** @license MIT License (c) copyright 2011-2013 original author or authors */
function(t){t("when/when",["require"],function(t){function e(t,e,n,r){return i(t).then(e,n,r)}function n(t){return new r(t,$.PromiseStatus&&$.PromiseStatus())}function r(t,e){function n(){return h?h.inspect():C()}function r(t,e,n,r,i){function s(s){s._when(t,e,n,r,i)}c?c.push(s):T(function(){s(h)})}function i(t){if(c){var n=c;c=V,h=l(a,t),T(function(){e&&d(h,e),u(n,h)})}}function s(t){i(new p(t))}function o(t){if(c){var e=c;T(function(){u(e,new f(t))})}}var a,h,c=[];a=this,this._status=e,this.inspect=n,this._when=r;try{t(i,s,o)}catch(g){s(g)}}function i(t){return t instanceof r?t:s(t)}function s(t){return n(function(e){e(t)})}function o(t){return e(t,function(t){return new p(t)})}function a(){function t(t,n,o){e.resolve=e.resolver.resolve=function(e){return i?s(e):(i=!0,t(e),r)},e.reject=e.resolver.reject=function(t){return i?s(new p(t)):(i=!0,n(t),r)},e.notify=e.resolver.notify=function(t){return o(t),t}}var e,r,i;return e={promise:V,resolve:V,reject:V,notify:V,resolver:{resolve:V,reject:V,notify:V}},e.promise=r=n(t),e}function u(t,e){for(var n=0;n<t.length;n++)t[n](e)}function l(t,e){if(e===t)return new p(new TypeError);if(e instanceof r)return e;try{var n=e===Object(e)&&e.then;return"function"==typeof n?h(n,e):new c(e)}catch(i){return new p(i)}}function h(t,e){return n(function(n,r){T(function(){try{H(t,e,n,r)}catch(i){r(i)}})})}function c(t){this.value=t}function p(t){this.value=t}function f(t){this.value=t}function d(t,e){function n(){e.fulfilled()}function r(t){e.rejected(t)}t.then(n,r)}function g(t){return t&&"function"==typeof t.then}function y(t,r,i,s,o){return e(t,function(t){function a(n,i,s){function o(t){f(t)}function a(t){p(t)}var u,l,h,c,p,f,d,g;if(d=t.length>>>0,u=Math.max(0,Math.min(r,d)),h=[],l=d-u+1,c=[],u)for(f=function(t){c.push(t),--l||(p=f=N,i(c))},p=function(t){h.push(t),--u||(p=f=N,n(h))},g=0;d>g;++g)g in t&&e(t[g],a,o,s);else n(h)}return n(a).then(i,s,o)})}function m(t,e,n,r){function i(t){return e?e(t[0]):t[0]}return y(t,1,i,n,r)}function v(t,e,n,r){return k(t,N).then(e,n,r)}function _(){return k(arguments,N)}function b(t){return k(t,S,E)}function w(t,e){return k(t,e)}function k(t,n,i){return e(t,function(t){function s(r,s,o){function a(t,a){e(t,n,i).then(function(t){u[a]=t,--h||r(u)},s,o)}var u,l,h,c;if(h=l=t.length>>>0,u=[],!h)return void r(u);for(c=0;l>c;c++)c in t?a(t[c],c):--h}return new r(s)})}function x(t,n){var r=H(R,arguments,1);return e(t,function(t){var i;return i=t.length,r[0]=function(t,r,s){return e(t,function(t){return e(r,function(e){return n(t,e,s,i)})})},M.apply(t,r)})}function S(t){return{state:"fulfilled",value:t}}function E(t){return{state:"rejected",reason:t}}function C(){return{state:"pending"}}function T(t){1===L.push(t)&&I(P)}function P(){u(L),L=[]}function N(t){return t}function A(t){throw"function"==typeof $.reportUnhandled?$.reportUnhandled():T(function(){throw t}),t}e.promise=n,e.resolve=s,e.reject=o,e.defer=a,e.join=_,e.all=v,e.map=w,e.reduce=x,e.settle=b,e.any=m,e.some=y,e.isPromise=g,e.isPromiseLike=g,O=r.prototype,O.then=function(t,e,n){var i=this;return new r(function(r,s,o){i._when(r,o,t,e,n)},this._status&&this._status.observed())},O["catch"]=O.otherwise=function(t){return this.then(V,t)},O["finally"]=O.ensure=function(t){function e(){return s(t())}return"function"==typeof t?this.then(e,e)["yield"](this):this},O.done=function(t,e){this.then(t,e)["catch"](A)},O["yield"]=function(t){return this.then(function(){return t})},O.tap=function(t){return this.then(t)["yield"](this)},O.spread=function(t){return this.then(function(e){return v(e,function(e){return t.apply(V,e)})})},O.always=function(t,e){return this.then(t,t,e)},j=Object.create||function(t){function e(){}return e.prototype=t,new e},c.prototype=j(O),c.prototype.inspect=function(){return S(this.value)},c.prototype._when=function(t,e,n){try{t("function"==typeof n?n(this.value):this.value)}catch(r){t(new p(r))}},p.prototype=j(O),p.prototype.inspect=function(){return E(this.value)},p.prototype._when=function(t,e,n,r){try{t("function"==typeof r?r(this.value):this)}catch(i){t(new p(i))}},f.prototype=j(O),f.prototype._when=function(t,e,n,r,i){try{e("function"==typeof i?i(this.value):this.value)}catch(s){e(s)}};var O,j,M,R,H,I,L,D,z,U,$,q,B,F,V;if(B=t,L=[],$="undefined"!=typeof console?console:e,"object"==typeof process&&process.nextTick)I=process.nextTick;else if(F="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver)I=function(t,e,n){var r=t.createElement("div");return new e(n).observe(r,{attributes:!0}),function(){r.setAttribute("x","x")}}(document,F,P);else try{I=B("vertx").runOnLoop||B("vertx").runOnContext}catch(J){q=setTimeout,I=function(t){q(t,0)}}return D=Function.prototype,z=D.call,H=D.bind?z.bind(z):function(t,e){return t.apply(e,R.call(arguments,2))},U=[],R=U.slice,M=U.reduce||function(t){var e,n,r,i,s;if(s=0,e=Object(this),i=e.length>>>0,n=arguments,n.length<=1)for(;;){if(s in e){r=e[s++];break}if(++s>=i)throw new TypeError}else r=n[1];for(;i>s;++s)s in e&&(r=t(r,e[s],s,e));return r},e})}("function"==typeof n&&n.amd?n:function(t){module.exports=t(e)}),n("when",["when/when"],function(t){return t}),function(){var t;t=function(){var t,e,n;t=document.createElement("zveloFakeElement"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in n)if(null!=t.style[e])return n[e]}(),n("element",["when"],function(e){var n,r;return r=function(){function r(t,e){var n;if(this.el=t,this._animate=e,null==this._animate&&(this._animate=!0),null!=this.el)switch(typeof this.el){case"string":n=document.createElement("div"),n.innerHTML=this.el,this.el=n.firstChild;break;case"object":this.el instanceof r&&(this.el=this.el.el)}}return r.prototype.animate=function(t){return null==t?this._animate:(this._animate=t,this)},r.prototype.html=function(t){return null==this.el?this:null==t?this.el.innerHTML:(this.el.innerHTML="",this.el.innerHTML=t,this.el.style.display="block",this)},r.prototype.text=function(){var t,e,r,i;if(3===(r=this.el.nodeType)||4===r)return this.el.nodeValue;if(1!==(i=this.el.nodeType)&&9!==i&&11!==i)return"";if("string"==typeof this.el.textContent)return this.el.textContent;for(e="",t=n(this.el.firstChild);t.el;)e+=t.text(),t=n(t.el.nextSibling);return e},r.prototype.on=function(t,e){return null==this.el?this:("addEventListener"in this.el?this.el.addEventListener(t,e,!1):this.el.attachEvent("on"+t,e),this)},r.prototype.off=function(t,e){return null==this.el?this:("removeEventListener"in this.el?this.el.removeEventListener(t,e,!1):this.el.detachEvent("on"+t,e),this)},r.prototype.find=function(t){return null==this.el?this:n(this.el.querySelector(t))},r.prototype.attr=function(t,e){return null==this.el?this:null==e?this.el.getAttribute(t):(this.el.setAttribute(t,e),this)},r.prototype.hasClass=function(t){return null==this.el?!1:(" "+this.el.className+" ").indexOf(" "+t+" ")>-1},r.prototype.addClass=function(t,n,r){var i,s,o;return null==this.el?this:(null==r&&(r=this),o=e.defer(),i=o.promise,s=o.resolver,null!=n&&i.then(n.bind(r)),this.hasClass(t)?s.resolve(this):(this.el.className+=" "+t,this._onComplete(s)),this)},r.prototype.removeClass=function(t,n,r){var i,s,o,a;return null==this.el?this:(null==r&&(r=this),a=e.defer(),i=a.promise,o=a.resolver,null!=n&&i.then(n.bind(r)),this.hasClass(t)?(s=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g"),this.el.className=this.el.className.replace(s,""),this._onComplete(o)):o.resolve(this),this)},r.prototype._onComplete=function(t){return this._animate?this._onTransitionEnd(t):t.resolve(this)},r.prototype._onTransitionEnd=function(e){var n;return null==t?e.resolve(this):(n=function(){return this.off(t,n),e.resolve(this)}.bind(this),this.on(t,n))},r.prototype.append=function(t){return null==this.el||null==t?this:(t=n(t),null==t.el?this:(this.el.appendChild(t.el),this))},r.prototype.remove=function(t){var e;return t=n(t),null!=(e=this.el)&&e.removeChild(t.el),this},r.prototype.display=function(t){var e;return null!=(e=this.el)&&(e.style.display=t),this},r.prototype.focus=function(){var t;return null!=(t=this.el)&&t.focus(),this},r.prototype.blur=function(){var t;return null!=(t=this.el)&&t.blur(),this},r.prototype.value=function(t){return null==this.el?this:null==t?this.el.value:(this.el.value=t,this)},r.prototype.options=function(t){var e,n,r;return null==t?null!=(e=this.el)?e.options:void 0:null!=(n=this.el)&&null!=(r=n.options)?r[t]:void 0},r.prototype.selectedIndex=function(){var t;return null!=(t=this.el)?t.selectedIndex:void 0},r.prototype.reflow=function(){var t;return null!=(t=this.el)&&t.offsetWidth,this},r}(),n=function(t,e){return new r(t,e)},n.transitionEnd=t,n})}.call(this),function(){n("placeholders",["element"],function(t){var e,n,r,i,s,o,a,u,l,h,c,p,f,d,g,y,m,v,_,b,w,k,x,S,E,C,T,P,N,A,O,j,M,R,H,I,L,D,z;return P=function(t,e){var n;return t.createTextRange?(n=t.createTextRange(),n.move("character",e),n.select()):t.selectionStart?(t.focus(),t.setSelectionRange(e,e)):void 0},c=function(t,e){var n;try{return t.type=e,!0}catch(r){return n=r,!1}},_=function(t,e){return-1!==t.indexOf(e)},z=["text","search","url","tel","email","password","number","textarea"],h=[27,33,34,35,36,37,38,39,40,8,46],M="#ccc",j="placeholdersjs",p=new RegExp("(?:^|\\s)"+j+"(?!\\S)"),n="data-placeholder-value",e="data-placeholder-active",s="data-placeholder-type",i="data-placeholder-submit",r="data-placeholder-bound",o="data-placeholder-focus",a="data-placeholder-live",D=document.createElement("input"),y=document.getElementsByTagName("head")[0],R=document.documentElement,w=!0,m=!0,b=void 0,O=function(){},v=function(t){var r;return t.value!==t.getAttribute(n)||"true"!==t.getAttribute(e)?!1:(t.setAttribute(e,"false"),t.value="",t.className=t.className.replace(p,""),r=t.getAttribute(s),r&&(t.type=r),!0)},L=function(t){var r,i;return i=t.getAttribute(n),""===t.value&&i?(t.setAttribute(e,"true"),t.value=i,t.className+=" "+j,r=t.getAttribute(s),r?t.type="text":"password"===t.type&&c(t,"text")&&t.setAttribute(s,"password"),!0):!1},g=function(t,e){var r,i,s,o,a,u,l,h;if(null!=t?t.getAttribute(n):void 0)return e(t);for(i=t?t.getElementsByTagName("input"):inputs,s=t?t.getElementsByTagName("textarea"):textareas,o=0,u=i.length;u>o;o++)r=i[o],e(r);for(h=[],a=0,l=s.length;l>a;a++)r=s[a],h.push(e(r));return h},f=function(t){return g(t,v)},d=function(t){return g(t,L)},S=function(t){return function(){return m&&t.value===t.getAttribute(n)&&"true"===t.getAttribute(e)?P(t,0):v(t)}},k=function(t){return function(){return L(t)}},E=function(t){return function(r){return"true"===t.getAttribute(e)&&_(h,r.keyCode)?(b=t.value,b===t.getAttribute(n)?(r.preventDefault&&r.preventDefault(),!1):void 0):void 0}},C=function(t){return function(){var r;return"true"===t.getAttribute(e)&&t.value!==b&&(t.className=t.className.replace(p,""),t.value=t.value.replace(t.getAttribute(n),""),t.setAttribute(e,!1),r=t.getAttribute(s),r&&(t.type=r)),""===t.value?(t.blur(),P(t,0)):void 0}},x=function(t){return function(){return t===document.activeElement&&t.value===t.getAttribute(n)&&"true"===t.getAttribute(e)?P(t,0):void 0}},T=function(t){return function(){return f(t)}},A=function(e,s){var o;return e=t(e),e.el.form&&(o=t(e.el.form),o.attr(i)||o.on("submit",T(o.el)).attr(i,"true")),e.on("focus",S(e.el)).on("blur",k(e.el)),m&&e.on("keydown",E(e.el)).on("keyup",C(e.el)).on("click",x(e.el)),e.attr(r,"true"),e.attr(n,s),L(e.el)},I=function(t){var e;return(e=t.attributes.placeholder)?(e=e.nodeValue,e&&_(z,t.type)?A(t,e):void 0):void 0},l=function(t){var e;return e=t.attributes.placeholder,e&&(e=e.nodeValue,e&&_(z,t.type)&&(t.getAttribute(r)||A(t,e),e!==t.getAttribute(n)||"password"===t.type&&!t.getAttribute(s)))?("password"===t.type&&!t.getAttribute(s)&&c(t,"text")&&t.setAttribute(s,"password"),t.value===t.getAttribute(n)&&(t.value=e),t.setAttribute(n,e)):void 0},N=void 0!==D.placeholder,u={nativeSupport:N,disable:N?O:f,enable:N?O:d},H=function(){var t,e,n,r,i,s,u,h,c,p,f;if(!N){for(e=document.getElementsByTagName("input"),s=document.getElementsByTagName("textarea"),m="false"===R.getAttribute(o),w="false"!==R.getAttribute(a),r=document.createElement("style"),r.type="text/css",i=document.createTextNode("."+j+" {"+("  color: "+M+";")+"}"),r.styleSheet?r.styleSheet.cssText=i.nodeValue:r.appendChild(i),y.insertBefore(r,y.firstChild),h=0,p=e.length;p>h;h++)t=e[h],I(t);for(c=0,f=s.length;f>c;c++)t=s[c],I(t);return n=function(){var n,r,i,o;for(n=0,i=e.length;i>n;n++)t=e[n],l(t);for(r=0,o=s.length;o>r;r++)t=s[r],l(t);return w?void 0:clearInterval(u)},u=setInterval(n,100)}},H(),u})}.call(this),/*!

 handlebars v2.0.0

Copyright (C) 2011-2014 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/
function(t,e){"function"==typeof n&&n.amd?n("handlebars",[],e):"object"==typeof exports?module.exports=e():t.Handlebars=t.Handlebars||e()}(this,function(){var t=function(){function t(t){this.string=t}var e;return t.prototype.toString=function(){return""+this.string},e=t}(),e=function(t){function e(t){return u[t]}function n(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}function r(t){return t instanceof a?t.toString():null==t?"":t?(t=""+t,h.test(t)?t.replace(l,e):t):t+""}function i(t){return t||0===t?f(t)&&0===t.length?!0:!1:!0}function s(t,e){return(t?t+".":"")+e}var o={},a=t,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,h=/[&<>"'`]/;o.extend=n;var c=Object.prototype.toString;o.toString=c;var p=function(t){return"function"==typeof t};p(/x/)&&(p=function(t){return"function"==typeof t&&"[object Function]"===c.call(t)});var p;o.isFunction=p;var f=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===c.call(t):!1};return o.isArray=f,o.escapeExpression=r,o.isEmpty=i,o.appendContextPath=s,o}(t),n=function(){function t(t,e){var r;e&&e.firstLine&&(r=e.firstLine,t+=" - "+r+":"+e.firstColumn);for(var i=Error.prototype.constructor.call(this,t),s=0;s<n.length;s++)this[n[s]]=i[n[s]];r&&(this.lineNumber=r,this.column=e.firstColumn)}var e,n=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=new Error,e=t}(),r=function(t,e){function n(t,e){this.helpers=t||{},this.partials=e||{},r(this)}function r(t){t.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new o("Missing helper: '"+arguments[arguments.length-1].name+"'")}),t.registerHelper("blockHelperMissing",function(e,n){var r=n.inverse,i=n.fn;if(e===!0)return i(this);if(e===!1||null==e)return r(this);if(h(e))return e.length>0?(n.ids&&(n.ids=[n.name]),t.helpers.each(e,n)):r(this);if(n.data&&n.ids){var o=y(n.data);o.contextPath=s.appendContextPath(n.data.contextPath,n.name),n={data:o}}return i(e,n)}),t.registerHelper("each",function(t,e){if(!e)throw new o("Must pass iterator to #each");var n,r,i=e.fn,a=e.inverse,u=0,l="";if(e.data&&e.ids&&(r=s.appendContextPath(e.data.contextPath,e.ids[0])+"."),c(t)&&(t=t.call(this)),e.data&&(n=y(e.data)),t&&"object"==typeof t)if(h(t))for(var p=t.length;p>u;u++)n&&(n.index=u,n.first=0===u,n.last=u===t.length-1,r&&(n.contextPath=r+u)),l+=i(t[u],{data:n});else for(var f in t)t.hasOwnProperty(f)&&(n&&(n.key=f,n.index=u,n.first=0===u,r&&(n.contextPath=r+f)),l+=i(t[f],{data:n}),u++);return 0===u&&(l=a(this)),l}),t.registerHelper("if",function(t,e){return c(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||s.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers["if"].call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),t.registerHelper("with",function(t,e){c(t)&&(t=t.call(this));var n=e.fn;if(s.isEmpty(t))return e.inverse(this);if(e.data&&e.ids){var r=y(e.data);r.contextPath=s.appendContextPath(e.data.contextPath,e.ids[0]),e={data:r}}return n(t,e)}),t.registerHelper("log",function(e,n){var r=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;t.log(r,e)}),t.registerHelper("lookup",function(t,e){return t&&t[e]})}var i={},s=t,o=e,a="2.0.0";i.VERSION=a;var u=6;i.COMPILER_REVISION=u;var l={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};i.REVISION_CHANGES=l;var h=s.isArray,c=s.isFunction,p=s.toString,f="[object Object]";i.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:d,log:g,registerHelper:function(t,e){if(p.call(t)===f){if(e)throw new o("Arg not supported with multiple helpers");s.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){p.call(t)===f?s.extend(this.partials,t):this.partials[t]=e},unregisterPartial:function(t){delete this.partials[t]}};var d={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(d.level<=t){var n=d.methodMap[t];"undefined"!=typeof console&&console[n]&&console[n].call(console,e)}}};i.logger=d;var g=d.log;i.log=g;var y=function(t){var e=s.extend({},t);return e._parent=t,e};return i.createFrame=y,i}(e,n),i=function(t,e,n){function r(t){var e=t&&t[0]||1,n=p;if(e!==n){if(n>e){var r=f[n],i=f[e];throw new c("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new c("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function i(t,e){if(!e)throw new c("No environment passed to template");if(!t||!t.main)throw new c("Unknown template object: "+typeof t);e.VM.checkRevision(t.compiler);var n=function(n,r,i,s,o,a,u,l,p){o&&(s=h.extend({},s,o));var f=e.VM.invokePartial.call(this,n,i,s,a,u,l,p);if(null==f&&e.compile){var d={helpers:a,partials:u,data:l,depths:p};u[i]=e.compile(n,{data:void 0!==l,compat:t.compat},e),f=u[i](s,d)}if(null!=f){if(r){for(var g=f.split("\n"),y=0,m=g.length;m>y&&(g[y]||y+1!==m);y++)g[y]=r+g[y];f=g.join("\n")}return f}throw new c("The partial "+i+" could not be compiled when running in runtime-only mode")},r={lookup:function(t,e){for(var n=t.length,r=0;n>r;r++)if(t[r]&&null!=t[r][e])return t[r][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:h.escapeExpression,invokePartial:n,fn:function(e){return t[e]},programs:[],program:function(t,e,n){var r=this.programs[t],i=this.fn(t);return e||n?r=s(this,t,i,e,n):r||(r=this.programs[t]=s(this,t,i)),r},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n=h.extend({},e,t)),n},noop:e.VM.noop,compilerInfo:t.compiler},i=function(e,n){n=n||{};var s=n.data;i._setup(n),!n.partial&&t.useData&&(s=u(e,s));var o;return t.useDepths&&(o=n.depths?[e].concat(n.depths):[e]),t.main.call(r,e,r.helpers,r.partials,s,o)};return i.isTop=!0,i._setup=function(n){n.partial?(r.helpers=n.helpers,r.partials=n.partials):(r.helpers=r.merge(n.helpers,e.helpers),t.usePartial&&(r.partials=r.merge(n.partials,e.partials)))},i._child=function(e,n,i){if(t.useDepths&&!i)throw new c("must pass parent depths");return s(r,e,t[e],n,i)},i}function s(t,e,n,r,i){var s=function(e,s){return s=s||{},n.call(t,e,t.helpers,t.partials,s.data||r,i&&[e].concat(i))};return s.program=e,s.depth=i?i.length:0,s}function o(t,e,n,r,i,s,o){var a={partial:!0,helpers:r,partials:i,data:s,depths:o};if(void 0===t)throw new c("The partial "+e+" could not be found");return t instanceof Function?t(n,a):void 0}function a(){return""}function u(t,e){return e&&"root"in e||(e=e?d(e):{},e.root=t),e}var l={},h=t,c=e,p=n.COMPILER_REVISION,f=n.REVISION_CHANGES,d=n.createFrame;return l.checkRevision=r,l.template=i,l.program=s,l.invokePartial=o,l.noop=a,l}(e,n,r),s=function(t,e,n,r,i){var s,o=t,a=e,u=n,l=r,h=i,c=function(){var t=new o.HandlebarsEnvironment;return l.extend(t,o),t.SafeString=a,t.Exception=u,t.Utils=l,t.escapeExpression=l.escapeExpression,t.VM=h,t.template=function(e){return h.template(e,t)},t},p=c();return p.create=c,p["default"]=p,s=p}(r,t,n,e,i),o=function(t){function e(t){t=t||{},this.firstLine=t.first_line,this.firstColumn=t.first_column,this.lastColumn=t.last_column,this.lastLine=t.last_line}var n,r=t,i={ProgramNode:function(t,n,r){e.call(this,r),this.type="program",this.statements=t,this.strip=n},MustacheNode:function(t,n,r,s,o){if(e.call(this,o),this.type="mustache",this.strip=s,null!=r&&r.charAt){var a=r.charAt(3)||r.charAt(2);this.escaped="{"!==a&&"&"!==a}else this.escaped=!!r;this.sexpr=t instanceof i.SexprNode?t:new i.SexprNode(t,n),this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(t,n,r){e.call(this,r),this.type="sexpr",this.hash=n;var i=this.id=t[0],s=this.params=t.slice(1);this.isHelper=!(!s.length&&!n),this.eligibleHelper=this.isHelper||i.isSimple},PartialNode:function(t,n,r,i,s){e.call(this,s),this.type="partial",this.partialName=t,this.context=n,this.hash=r,this.strip=i,this.strip.inlineStandalone=!0},BlockNode:function(t,n,r,i,s){e.call(this,s),this.type="block",this.mustache=t,this.program=n,this.inverse=r,this.strip=i,r&&!n&&(this.isInverse=!0)},RawBlockNode:function(t,n,s,o){if(e.call(this,o),t.sexpr.id.original!==s)throw new r(t.sexpr.id.original+" doesn't match "+s,this);n=new i.ContentNode(n,o),this.type="block",this.mustache=t,this.program=new i.ProgramNode([n],{},o)},ContentNode:function(t,n){e.call(this,n),this.type="content",this.original=this.string=t},HashNode:function(t,n){e.call(this,n),this.type="hash",this.pairs=t},IdNode:function(t,n){e.call(this,n),this.type="ID";for(var i="",s=[],o=0,a="",u=0,l=t.length;l>u;u++){var h=t[u].part;if(i+=(t[u].separator||"")+h,".."===h||"."===h||"this"===h){if(s.length>0)throw new r("Invalid path: "+i,this);".."===h?(o++,a+="../"):this.isScoped=!0}else s.push(h)}this.original=i,this.parts=s,this.string=s.join("."),this.depth=o,this.idName=a+this.string,this.isSimple=1===t.length&&!this.isScoped&&0===o,this.stringModeValue=this.string},PartialNameNode:function(t,n){e.call(this,n),this.type="PARTIAL_NAME",this.name=t.original},DataNode:function(t,n){e.call(this,n),this.type="DATA",this.id=t,this.stringModeValue=t.stringModeValue,this.idName="@"+t.stringModeValue},StringNode:function(t,n){e.call(this,n),this.type="STRING",this.original=this.string=this.stringModeValue=t},NumberNode:function(t,n){e.call(this,n),this.type="NUMBER",this.original=this.number=t,this.stringModeValue=Number(t)},BooleanNode:function(t,n){e.call(this,n),this.type="BOOLEAN",this.bool=t,this.stringModeValue="true"===t},CommentNode:function(t,n){e.call(this,n),this.type="comment",this.comment=t,this.strip={inlineStandalone:!0}}};return n=i}(n),a=function(){var t,e=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,CONTENT:12,COMMENT:13,openRawBlock:14,END_RAW_BLOCK:15,OPEN_RAW_BLOCK:16,sexpr:17,CLOSE_RAW_BLOCK:18,openBlock:19,block_option0:20,closeBlock:21,openInverse:22,block_option1:23,OPEN_BLOCK:24,CLOSE:25,OPEN_INVERSE:26,inverseAndProgram:27,INVERSE:28,OPEN_ENDBLOCK:29,path:30,OPEN:31,OPEN_UNESCAPED:32,CLOSE_UNESCAPED:33,OPEN_PARTIAL:34,partialName:35,param:36,partial_option0:37,partial_option1:38,sexpr_repetition0:39,sexpr_option0:40,dataName:41,STRING:42,NUMBER:43,BOOLEAN:44,OPEN_SEXPR:45,CLOSE_SEXPR:46,hash:47,hash_repetition_plus0:48,hashSegment:49,ID:50,EQUALS:51,DATA:52,pathSegments:53,SEP:54,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"CONTENT",13:"COMMENT",15:"END_RAW_BLOCK",16:"OPEN_RAW_BLOCK",18:"CLOSE_RAW_BLOCK",24:"OPEN_BLOCK",25:"CLOSE",26:"OPEN_INVERSE",28:"INVERSE",29:"OPEN_ENDBLOCK",31:"OPEN",32:"OPEN_UNESCAPED",33:"CLOSE_UNESCAPED",34:"OPEN_PARTIAL",42:"STRING",43:"NUMBER",44:"BOOLEAN",45:"OPEN_SEXPR",46:"CLOSE_SEXPR",50:"ID",51:"EQUALS",52:"DATA",54:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[10,3],[14,3],[9,4],[9,4],[19,3],[22,3],[27,2],[21,3],[8,3],[8,3],[11,5],[11,4],[17,3],[17,1],[36,1],[36,1],[36,1],[36,1],[36,1],[36,3],[47,1],[49,3],[35,1],[35,1],[35,1],[41,2],[30,1],[53,3],[53,1],[6,0],[6,2],[20,0],[20,1],[23,0],[23,1],[37,0],[37,1],[38,0],[38,1],[39,0],[39,2],[40,0],[40,1],[48,1],[48,2]],performAction:function(t,e,n,r,i,s){var o=s.length-1;switch(i){case 1:return r.prepareProgram(s[o-1].statements,!0),s[o-1];case 2:this.$=new r.ProgramNode(r.prepareProgram(s[o]),{},this._$);break;case 3:this.$=s[o];break;case 4:this.$=s[o];break;case 5:this.$=s[o];break;case 6:this.$=s[o];break;case 7:this.$=new r.ContentNode(s[o],this._$);break;case 8:this.$=new r.CommentNode(s[o],this._$);break;case 9:this.$=new r.RawBlockNode(s[o-2],s[o-1],s[o],this._$);break;case 10:this.$=new r.MustacheNode(s[o-1],null,"","",this._$);break;case 11:this.$=r.prepareBlock(s[o-3],s[o-2],s[o-1],s[o],!1,this._$);break;case 12:this.$=r.prepareBlock(s[o-3],s[o-2],s[o-1],s[o],!0,this._$);break;case 13:this.$=new r.MustacheNode(s[o-1],null,s[o-2],r.stripFlags(s[o-2],s[o]),this._$);break;case 14:this.$=new r.MustacheNode(s[o-1],null,s[o-2],r.stripFlags(s[o-2],s[o]),this._$);break;case 15:this.$={strip:r.stripFlags(s[o-1],s[o-1]),program:s[o]};break;case 16:this.$={path:s[o-1],strip:r.stripFlags(s[o-2],s[o])};break;case 17:this.$=new r.MustacheNode(s[o-1],null,s[o-2],r.stripFlags(s[o-2],s[o]),this._$);break;case 18:this.$=new r.MustacheNode(s[o-1],null,s[o-2],r.stripFlags(s[o-2],s[o]),this._$);break;case 19:this.$=new r.PartialNode(s[o-3],s[o-2],s[o-1],r.stripFlags(s[o-4],s[o]),this._$);break;case 20:this.$=new r.PartialNode(s[o-2],void 0,s[o-1],r.stripFlags(s[o-3],s[o]),this._$);break;case 21:this.$=new r.SexprNode([s[o-2]].concat(s[o-1]),s[o],this._$);break;case 22:this.$=new r.SexprNode([s[o]],null,this._$);break;case 23:this.$=s[o];break;case 24:this.$=new r.StringNode(s[o],this._$);break;case 25:this.$=new r.NumberNode(s[o],this._$);break;case 26:this.$=new r.BooleanNode(s[o],this._$);break;case 27:this.$=s[o];break;case 28:s[o-1].isHelper=!0,this.$=s[o-1];break;case 29:this.$=new r.HashNode(s[o],this._$);break;case 30:this.$=[s[o-2],s[o]];break;case 31:this.$=new r.PartialNameNode(s[o],this._$);break;case 32:this.$=new r.PartialNameNode(new r.StringNode(s[o],this._$),this._$);break;case 33:this.$=new r.PartialNameNode(new r.NumberNode(s[o],this._$));break;case 34:this.$=new r.DataNode(s[o],this._$);break;case 35:this.$=new r.IdNode(s[o],this._$);break;case 36:s[o-2].push({part:s[o],separator:s[o-1]}),this.$=s[o-2];break;case 37:this.$=[{part:s[o]}];break;case 38:this.$=[];break;case 39:s[o-1].push(s[o]);break;case 48:this.$=[];break;case 49:s[o-1].push(s[o]);break;case 52:this.$=[s[o]];break;case 53:s[o-1].push(s[o])}},table:[{3:1,4:2,5:[2,38],6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],31:[2,38],32:[2,38],34:[2,38]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:[1,10],13:[1,11],14:16,16:[1,20],19:14,22:15,24:[1,18],26:[1,19],28:[2,2],29:[2,2],31:[1,12],32:[1,13],34:[1,17]},{1:[2,1]},{5:[2,39],12:[2,39],13:[2,39],16:[2,39],24:[2,39],26:[2,39],28:[2,39],29:[2,39],31:[2,39],32:[2,39],34:[2,39]},{5:[2,3],12:[2,3],13:[2,3],16:[2,3],24:[2,3],26:[2,3],28:[2,3],29:[2,3],31:[2,3],32:[2,3],34:[2,3]},{5:[2,4],12:[2,4],13:[2,4],16:[2,4],24:[2,4],26:[2,4],28:[2,4],29:[2,4],31:[2,4],32:[2,4],34:[2,4]},{5:[2,5],12:[2,5],13:[2,5],16:[2,5],24:[2,5],26:[2,5],28:[2,5],29:[2,5],31:[2,5],32:[2,5],34:[2,5]},{5:[2,6],12:[2,6],13:[2,6],16:[2,6],24:[2,6],26:[2,6],28:[2,6],29:[2,6],31:[2,6],32:[2,6],34:[2,6]},{5:[2,7],12:[2,7],13:[2,7],16:[2,7],24:[2,7],26:[2,7],28:[2,7],29:[2,7],31:[2,7],32:[2,7],34:[2,7]},{5:[2,8],12:[2,8],13:[2,8],16:[2,8],24:[2,8],26:[2,8],28:[2,8],29:[2,8],31:[2,8],32:[2,8],34:[2,8]},{17:21,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:27,30:22,41:23,50:[1,26],52:[1,25],53:24},{4:28,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{4:29,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{12:[1,30]},{30:32,35:31,42:[1,33],43:[1,34],50:[1,26],53:24},{17:35,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:36,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:37,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[1,38]},{18:[2,48],25:[2,48],33:[2,48],39:39,42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],50:[2,48],52:[2,48]},{18:[2,22],25:[2,22],33:[2,22],46:[2,22]},{18:[2,35],25:[2,35],33:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],50:[2,35],52:[2,35],54:[1,40]},{30:41,50:[1,26],53:24},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],52:[2,37],54:[2,37]},{33:[1,42]},{20:43,27:44,28:[1,45],29:[2,40]},{23:46,27:47,28:[1,45],29:[2,42]},{15:[1,48]},{25:[2,46],30:51,36:49,38:50,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],47:57,48:58,49:60,50:[1,59],52:[1,25],53:24},{25:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],50:[2,31],52:[2,31]},{25:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],50:[2,32],52:[2,32]},{25:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],50:[2,33],52:[2,33]},{25:[1,61]},{25:[1,62]},{18:[1,63]},{5:[2,17],12:[2,17],13:[2,17],16:[2,17],24:[2,17],26:[2,17],28:[2,17],29:[2,17],31:[2,17],32:[2,17],34:[2,17]},{18:[2,50],25:[2,50],30:51,33:[2,50],36:65,40:64,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],46:[2,50],47:66,48:58,49:60,50:[1,59],52:[1,25],53:24},{50:[1,67]},{18:[2,34],25:[2,34],33:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],50:[2,34],52:[2,34]},{5:[2,18],12:[2,18],13:[2,18],16:[2,18],24:[2,18],26:[2,18],28:[2,18],29:[2,18],31:[2,18],32:[2,18],34:[2,18]},{21:68,29:[1,69]},{29:[2,41]},{4:70,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{21:71,29:[1,69]},{29:[2,43]},{5:[2,9],12:[2,9],13:[2,9],16:[2,9],24:[2,9],26:[2,9],28:[2,9],29:[2,9],31:[2,9],32:[2,9],34:[2,9]},{25:[2,44],37:72,47:73,48:58,49:60,50:[1,74]},{25:[1,75]},{18:[2,23],25:[2,23],33:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],50:[2,23],52:[2,23]},{18:[2,24],25:[2,24],33:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],50:[2,24],52:[2,24]},{18:[2,25],25:[2,25],33:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],50:[2,25],52:[2,25]},{18:[2,26],25:[2,26],33:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],50:[2,26],52:[2,26]},{18:[2,27],25:[2,27],33:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],50:[2,27],52:[2,27]},{17:76,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[2,47]},{18:[2,29],25:[2,29],33:[2,29],46:[2,29],49:77,50:[1,74]},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],51:[1,78],52:[2,37],54:[2,37]},{18:[2,52],25:[2,52],33:[2,52],46:[2,52],50:[2,52]},{12:[2,13],13:[2,13],16:[2,13],24:[2,13],26:[2,13],28:[2,13],29:[2,13],31:[2,13],32:[2,13],34:[2,13]},{12:[2,14],13:[2,14],16:[2,14],24:[2,14],26:[2,14],28:[2,14],29:[2,14],31:[2,14],32:[2,14],34:[2,14]},{12:[2,10]},{18:[2,21],25:[2,21],33:[2,21],46:[2,21]},{18:[2,49],25:[2,49],33:[2,49],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],50:[2,49],52:[2,49]},{18:[2,51],25:[2,51],33:[2,51],46:[2,51]},{18:[2,36],25:[2,36],33:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],50:[2,36],52:[2,36],54:[2,36]},{5:[2,11],12:[2,11],13:[2,11],16:[2,11],24:[2,11],26:[2,11],28:[2,11],29:[2,11],31:[2,11],32:[2,11],34:[2,11]},{30:79,50:[1,26],53:24},{29:[2,15]},{5:[2,12],12:[2,12],13:[2,12],16:[2,12],24:[2,12],26:[2,12],28:[2,12],29:[2,12],31:[2,12],32:[2,12],34:[2,12]},{25:[1,80]},{25:[2,45]},{51:[1,78]},{5:[2,20],12:[2,20],13:[2,20],16:[2,20],24:[2,20],26:[2,20],28:[2,20],29:[2,20],31:[2,20],32:[2,20],34:[2,20]},{46:[1,81]},{18:[2,53],25:[2,53],33:[2,53],46:[2,53],50:[2,53]},{30:51,36:82,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],50:[1,26],52:[1,25],53:24},{25:[1,83]},{5:[2,19],12:[2,19],13:[2,19],16:[2,19],24:[2,19],26:[2,19],28:[2,19],29:[2,19],31:[2,19],32:[2,19],34:[2,19]},{18:[2,28],25:[2,28],33:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],50:[2,28],52:[2,28]},{18:[2,30],25:[2,30],33:[2,30],46:[2,30],50:[2,30]},{5:[2,16],12:[2,16],13:[2,16],16:[2,16],24:[2,16],26:[2,16],28:[2,16],29:[2,16],31:[2,16],32:[2,16],34:[2,16]}],defaultActions:{4:[2,1],44:[2,41],47:[2,43],57:[2,47],63:[2,10],70:[2,15],73:[2,45]},parseError:function(t){throw new Error(t)},parse:function(t){function e(){var t;return t=n.lexer.lex()||1,"number"!=typeof t&&(t=n.symbols_[t]||t),t}var n=this,r=[0],i=[null],s=[],o=this.table,a="",u=0,l=0,h=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var c=this.lexer.yylloc;s.push(c);var p=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var f,d,g,y,m,v,_,b,w,k={};;){if(g=r[r.length-1],this.defaultActions[g]?y=this.defaultActions[g]:((null===f||"undefined"==typeof f)&&(f=e()),y=o[g]&&o[g][f]),"undefined"==typeof y||!y.length||!y[0]){var x="";if(!h){w=[];for(v in o[g])this.terminals_[v]&&v>2&&w.push("'"+this.terminals_[v]+"'");x=this.lexer.showPosition?"Parse error on line "+(u+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[f]||f)+"'":"Parse error on line "+(u+1)+": Unexpected "+(1==f?"end of input":"'"+(this.terminals_[f]||f)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[f]||f,line:this.lexer.yylineno,loc:c,expected:w})}}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+f);switch(y[0]){case 1:r.push(f),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(y[1]),f=null,d?(f=d,d=null):(l=this.lexer.yyleng,a=this.lexer.yytext,u=this.lexer.yylineno,c=this.lexer.yylloc,h>0&&h--);break;case 2:if(_=this.productions_[y[1]][1],k.$=i[i.length-_],k._$={first_line:s[s.length-(_||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(_||1)].first_column,last_column:s[s.length-1].last_column},p&&(k._$.range=[s[s.length-(_||1)].range[0],s[s.length-1].range[1]]),m=this.performAction.call(k,a,l,u,this.yy,y[1],i,s),"undefined"!=typeof m)return m;_&&(r=r.slice(0,-1*_*2),i=i.slice(0,-1*_),s=s.slice(0,-1*_)),r.push(this.productions_[y[1]][0]),i.push(k.$),s.push(k._$),b=o[r[r.length-2]][r[r.length-1]],r.push(b);break;case 3:return!0}}return!0}},n=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,r,i;this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),o=0;o<s.length&&(n=this._input.match(this.rules[s[o]]),!n||e&&!(n[0].length>e[0].length)||(e=n,r=o,this.options.flex));o++);return e?(i=e[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,s[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n,r){function i(t,n){return e.yytext=e.yytext.substr(t,e.yyleng-n)}switch(n){case 0:if("\\\\"===e.yytext.slice(-2)?(i(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(i(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 12;break;case 1:return 12;case 2:return this.popState(),12;case 3:return e.yytext=e.yytext.substr(5,e.yyleng-9),this.popState(),15;case 4:return 12;case 5:return i(0,4),this.popState(),13;case 6:return 45;case 7:return 46;case 8:return 16;case 9:return this.popState(),this.begin("raw"),18;case 10:return 34;case 11:return 24;case 12:return 29;case 13:return this.popState(),28;case 14:return this.popState(),28;case 15:return 26;case 16:return 26;case 17:return 32;case 18:return 31;case 19:this.popState(),this.begin("com");break;case 20:return i(3,5),this.popState(),13;case 21:return 31;case 22:return 51;case 23:return 50;case 24:return 50;case 25:return 54;case 26:break;case 27:return this.popState(),33;case 28:return this.popState(),25;case 29:return e.yytext=i(1,2).replace(/\\"/g,'"'),42;case 30:return e.yytext=i(1,2).replace(/\\'/g,"'"),42;case 31:return 52;case 32:return 44;case 33:return 44;case 34:return 43;case 35:return 50;case 36:return e.yytext=i(1,2),50;case 37:return"INVALID";case 38:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,38],inclusive:!0}},t}();return e.lexer=n,t.prototype=e,e.Parser=t,new t}();return t=e}(),u=function(t){function e(t,e){return{left:"~"===t.charAt(2),right:"~"===e.charAt(e.length-3)}}function n(t,e,n,r,u,h){if(t.sexpr.id.original!==r.path.original)throw new l(t.sexpr.id.original+" doesn't match "+r.path.original,t);var c=n&&n.program,p={left:t.strip.left,right:r.strip.right,openStandalone:s(e.statements),closeStandalone:i((c||e).statements)};if(t.strip.right&&o(e.statements,null,!0),c){var f=n.strip;f.left&&a(e.statements,null,!0),f.right&&o(c.statements,null,!0),r.strip.left&&a(c.statements,null,!0),i(e.statements)&&s(c.statements)&&(a(e.statements),o(c.statements))}else r.strip.left&&a(e.statements,null,!0);return u?new this.BlockNode(t,c,e,p,h):new this.BlockNode(t,e,c,p,h)}function r(t,e){for(var n=0,r=t.length;r>n;n++){var u=t[n],l=u.strip;if(l){var h=i(t,n,e,"partial"===u.type),c=s(t,n,e),p=l.openStandalone&&h,f=l.closeStandalone&&c,d=l.inlineStandalone&&h&&c;l.right&&o(t,n,!0),l.left&&a(t,n,!0),d&&(o(t,n),a(t,n)&&"partial"===u.type&&(u.indent=/([ \t]+$)/.exec(t[n-1].original)?RegExp.$1:"")),p&&(o((u.program||u.inverse).statements),a(t,n)),f&&(o(t,n),a((u.inverse||u.program).statements))}}return t}function i(t,e,n){void 0===e&&(e=t.length);var r=t[e-1],i=t[e-2];return r?"content"===r.type?(i||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(r.original):void 0:n}function s(t,e,n){void 0===e&&(e=-1);var r=t[e+1],i=t[e+2];return r?"content"===r.type?(i||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(r.original):void 0:n}function o(t,e,n){var r=t[null==e?0:e+1];if(r&&"content"===r.type&&(n||!r.rightStripped)){var i=r.string;r.string=r.string.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),r.rightStripped=r.string!==i}}function a(t,e,n){var r=t[null==e?t.length-1:e-1];if(r&&"content"===r.type&&(n||!r.leftStripped)){var i=r.string;return r.string=r.string.replace(n?/\s+$/:/[ \t]+$/,""),r.leftStripped=r.string!==i,r.leftStripped}}var u={},l=t;return u.stripFlags=e,u.prepareBlock=n,u.prepareProgram=r,u}(n),l=function(t,e,n,r){function i(t){return t.constructor===a.ProgramNode?t:(o.yy=h,o.parse(t))}var s={},o=t,a=e,u=n,l=r.extend;s.parser=o;var h={};return l(h,u,a),s.parse=i,s}(a,o,u,e),h=function(t,e){function n(){}function r(t,e,n){if(null==t||"string"!=typeof t&&t.constructor!==n.AST.ProgramNode)throw new a("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var r=n.parse(t),i=(new n.Compiler).compile(r,e);return(new n.JavaScriptCompiler).compile(i,e)}function i(t,e,n){function r(){var r=n.parse(t),i=(new n.Compiler).compile(r,e),s=(new n.JavaScriptCompiler).compile(i,e,void 0,!0);return n.template(s)}if(null==t||"string"!=typeof t&&t.constructor!==n.AST.ProgramNode)throw new a("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var i,s=function(t,e){return i||(i=r()),i.call(this,t,e)};return s._setup=function(t){return i||(i=r()),i._setup(t)},s._child=function(t,e,n){return i||(i=r()),i._child(t,e,n)},s}function s(t,e){if(t===e)return!0;if(u(t)&&u(e)&&t.length===e.length){for(var n=0;n<t.length;n++)if(!s(t[n],e[n]))return!1;return!0}}var o={},a=t,u=e.isArray,l=[].slice;return o.Compiler=n,n.prototype={compiler:n,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var n=0;e>n;n++){var r=this.opcodes[n],i=t.opcodes[n];if(r.opcode!==i.opcode||!s(r.args,i.args))return!1}for(e=this.children.length,n=0;e>n;n++)if(!this.children[n].equals(t.children[n]))return!1;return!0},guid:0,compile:function(t,e){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds;var n=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.accept(t)},accept:function(t){return this[t.type](t)},program:function(t){for(var e=t.statements,n=0,r=e.length;r>n;n++)this.accept(e[n]);return this.isSimple=1===r,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,n=(new this.compiler).compile(t,this.options),r=this.guid++;this.usePartial=this.usePartial||n.usePartial,this.children[r]=n;
for(var i=0,s=n.depths.list.length;s>i;i++)e=n.depths.list[i],2>e||this.addDepth(e-1);return r},block:function(t){var e=t.mustache,n=t.program,r=t.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=e.sexpr,s=this.classifySexpr(i);"helper"===s?this.helperSexpr(i,n,r):"simple"===s?(this.simpleSexpr(i),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",i.id.original)):(this.ambiguousSexpr(i,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,n,r=t.pairs;for(this.opcode("pushHash"),e=0,n=r.length;n>e;e++)this.pushParam(r[e][1]);for(;e--;)this.opcode("assignToHash",r[e][0]);this.opcode("popHash")},partial:function(t){var e=t.partialName;this.usePartial=!0,t.hash?this.accept(t.hash):this.opcode("push","undefined"),t.context?this.accept(t.context):(this.opcode("getContext",0),this.opcode("pushContext")),this.opcode("invokePartial",e.name,t.indent||""),this.opcode("append")},content:function(t){t.string&&this.opcode("appendContent",t.string)},mustache:function(t){this.sexpr(t.sexpr),this.opcode(t.escaped&&!this.options.noEscape?"appendEscaped":"append")},ambiguousSexpr:function(t,e,n){var r=t.id,i=r.parts[0],s=null!=e||null!=n;this.opcode("getContext",r.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.ID(r),this.opcode("invokeAmbiguous",i,s)},simpleSexpr:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,n){var r=this.setupFullMustacheParams(t,e,n),i=t.id,s=i.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",r.length,s);else{if(this.options.knownHelpersOnly)throw new a("You specified knownHelpersOnly, but used the unknown helper "+s,t);i.falsy=!0,this.ID(i),this.opcode("invokeHelper",r.length,i.original,i.isSimple)}},sexpr:function(t){var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0];e?this.opcode("lookupOnContext",t.parts,t.falsy,t.isScoped):this.opcode("pushContext")},DATA:function(t){this.options.data=!0,this.opcode("lookupData",t.id.depth,t.id.parts)},STRING:function(t){this.opcode("pushString",t.string)},NUMBER:function(t){this.opcode("pushLiteral",t.number)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:l.call(arguments,1)})},addDepth:function(t){0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifySexpr:function(t){var e=t.isHelper,n=t.eligibleHelper,r=this.options;if(n&&!e){var i=t.id.parts[0];r.knownHelpers[i]?e=!0:r.knownHelpersOnly&&(n=!1)}return e?"helper":n?"ambiguous":"simple"},pushParams:function(t){for(var e=0,n=t.length;n>e;e++)this.pushParam(t[e])},pushParam:function(t){this.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.stringModeValue,t.type),"sexpr"===t.type&&this.sexpr(t)):(this.trackIds&&this.opcode("pushId",t.type,t.idName||t.stringModeValue),this.accept(t))},setupFullMustacheParams:function(t,e,n){var r=t.params;return this.pushParams(r),this.opcode("pushProgram",e),this.opcode("pushProgram",n),t.hash?this.hash(t.hash):this.opcode("emptyHash"),r}},o.precompile=r,o.compile=i,o}(n,e),c=function(t,e){function n(t){this.value=t}function r(){}var i,s=t.COMPILER_REVISION,o=t.REVISION_CHANGES,a=e;r.prototype={nameLookup:function(t,e){return r.isValidJavaScriptVariableName(e)?t+"."+e:t+"['"+e+"']"},depthedLookup:function(t){return this.aliases.lookup="this.lookup",'lookup(depths, "'+t+'")'},compilerInfo:function(){var t=s,e=o[t];return[t,e]},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":{appendToBuffer:!0,content:t,toString:function(){return"buffer += "+t+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,e,n,r){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!r,this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.depths.list.length||this.options.compat;var i,s,o,u=t.opcodes;for(s=0,o=u.length;o>s;s++)i=u[s],this[i.opcode].apply(this,i.args);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new a("Compile completed with content left on stack");var l=this.createFunctionContext(r);if(this.isChild)return l;var h={compiler:this.compilerInfo(),main:l},c=this.context.programs;for(s=0,o=c.length;o>s;s++)c[s]&&(h[s]=c[s]);return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.options.compat&&(h.compat=!0),r||(h.compiler=JSON.stringify(h.compiler),h=this.objectLiteral(h)),h},preamble:function(){this.lastContext=0,this.source=[]},createFunctionContext:function(t){var e="",n=this.stackVars.concat(this.registers.list);n.length>0&&(e+=", "+n.join(", "));for(var r in this.aliases)this.aliases.hasOwnProperty(r)&&(e+=", "+r+"="+this.aliases[r]);var i=["depth0","helpers","partials","data"];this.useDepths&&i.push("depths");var s=this.mergeSource(e);return t?(i.push(s),Function.apply(this,i)):"function("+i.join(",")+") {\n  "+s+"}"},mergeSource:function(t){for(var e,n,r="",i=!this.forceBuffer,s=0,o=this.source.length;o>s;s++){var a=this.source[s];a.appendToBuffer?e=e?e+"\n    + "+a.content:a.content:(e&&(r?r+="buffer += "+e+";\n  ":(n=!0,r=e+";\n  "),e=void 0),r+=a+"\n  ",this.environment.isSimple||(i=!1))}return i?(e||!r)&&(r+="return "+(e||'""')+";\n"):(t+=", buffer = "+(n?"":this.initializeBuffer()),r+=e?"return buffer + "+e+";\n":"return buffer;\n"),t&&(r="var "+t.substring(2)+(n?"":";\n  ")+r),r},blockValue:function(t){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=[this.contextName(0)];this.setupParams(t,0,e);var n=this.popStack();e.splice(1,0,n),this.push("blockHelperMissing.call("+e.join(", ")+")")},ambiguousBlockValue:function(){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=[this.contextName(0)];this.setupParams("",0,t,!0),this.flushInline();var e=this.topStack();t.splice(1,0,e),this.pushSource("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){this.pendingContent&&(t=this.pendingContent+t),this.pendingContent=t},append:function(){this.flushInline();var t=this.popStack();this.pushSource("if ("+t+" != null) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,n){var r=0,i=t.length;for(n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[r++]));i>r;r++)this.replaceStack(function(n){var i=this.nameLookup(n,t[r],"context");return e?" && "+i:" != null ? "+i+" : "+n})},lookupData:function(t,e){this.pushStackLiteral(t?"this.data(data, "+t+")":"data");for(var n=e.length,r=0;n>r;r++)this.replaceStack(function(t){return" && "+this.nameLookup(t,e[r],"data")})},resolvePossibleLambda:function(){this.aliases.lambda="this.lambda",this.push("lambda("+this.popStack()+", "+this.contextName(0)+")")},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"sexpr"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(){this.pushStackLiteral("{}"),this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push("{"+t.ids.join(",")+"}"),this.stringParams&&(this.push("{"+t.contexts.join(",")+"}"),this.push("{"+t.types.join(",")+"}")),this.push("{\n    "+t.values.join(",\n    ")+"\n  }")},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){return this.inlineStack.push(t),t},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){this.pushStackLiteral(null!=t?this.programExpression(t):null)},invokeHelper:function(t,e,n){this.aliases.helperMissing="helpers.helperMissing";var r=this.popStack(),i=this.setupHelper(t,e),s=(n?i.name+" || ":"")+r+" || helperMissing";this.push("(("+s+").call("+i.callParams+"))")},invokeKnownHelper:function(t,e){var n=this.setupHelper(t,e);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(t,e){this.aliases.functionType='"function"',this.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var n=this.popStack();this.emptyHash();var r=this.setupHelper(0,t,e),i=this.lastHelper=this.nameLookup("helpers",t,"helper");this.push("((helper = (helper = "+i+" || "+n+") != null ? helper : helperMissing"+(r.paramsInit?"),("+r.paramsInit:"")+"),(typeof helper === functionType ? helper.call("+r.callParams+") : helper))")},invokePartial:function(t,e){var n=[this.nameLookup("partials",t,"partial"),"'"+e+"'","'"+t+"'",this.popStack(),this.popStack(),"helpers","partials"];this.options.data?n.push("data"):this.options.compat&&n.push("undefined"),this.options.compat&&n.push("depths"),this.push("this.invokePartial("+n.join(", ")+")")},assignToHash:function(t){var e,n,r,i=this.popStack();this.trackIds&&(r=this.popStack()),this.stringParams&&(n=this.popStack(),e=this.popStack());var s=this.hash;e&&s.contexts.push("'"+t+"': "+e),n&&s.types.push("'"+t+"': "+n),r&&s.ids.push("'"+t+"': "+r),s.values.push("'"+t+"': ("+i+")")},pushId:function(t,e){"ID"===t||"DATA"===t?this.pushString(e):this.pushStackLiteral("sexpr"===t?"true":"null")},compiler:r,compileChildren:function(t,e){for(var n,r,i=t.children,s=0,o=i.length;o>s;s++){n=i[s],r=new this.compiler;var a=this.matchExistingProgram(n);null==a?(this.context.programs.push(""),a=this.context.programs.length,n.index=a,n.name="program"+a,this.context.programs[a]=r.compile(n,e,this.context,!this.precompile),this.context.environments[a]=n,this.useDepths=this.useDepths||r.useDepths):(n.index=a,n.name="program"+a)}},matchExistingProgram:function(t){for(var e=0,n=this.context.environments.length;n>e;e++){var r=this.context.environments[e];if(r&&r.equals(t))return e}},programExpression:function(t){var e=this.environment.children[t],n=(e.depths.list,this.useDepths),r=[e.index,"data"];return n&&r.push("depths"),"this.program("+r.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.push(new n(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),t&&this.source.push(t)},pushStack:function(t){this.flushInline();var e=this.incrStack();return this.pushSource(e+" = "+t+";"),this.compileStack.push(e),e},replaceStack:function(t){{var e,r,i,s="";this.isInline()}if(!this.isInline())throw new a("replaceStack on non-inline");var o=this.popStack(!0);if(o instanceof n)s=e=o.value,i=!0;else{r=!this.stackSlot;var u=r?this.incrStack():this.topStackName();s="("+this.push(u)+" = "+o+")",e=this.topStack()}var l=t.call(this,e);i||this.popStack(),r&&this.stackSlot--,this.push("("+s+l+")")},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;if(t.length){this.inlineStack=[];for(var e=0,r=t.length;r>e;e++){var i=t[e];i instanceof n?this.compileStack.push(i):this.pushStack(i)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),r=(e?this.inlineStack:this.compileStack).pop();if(!t&&r instanceof n)return r.value;if(!e){if(!this.stackSlot)throw new a("Invalid stack pop");this.stackSlot--}return r},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof n?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(this.quotedString(n)+":"+t[n]);return"{"+e.join(",")+"}"},setupHelper:function(t,e,n){var r=[],i=this.setupParams(e,t,r,n),s=this.nameLookup("helpers",e,"helper");return{params:r,paramsInit:i,name:s,callParams:[this.contextName(0)].concat(r).join(", ")}},setupOptions:function(t,e,n){var r,i,s,o={},a=[],u=[],l=[];o.name=this.quotedString(t),o.hash=this.popStack(),this.trackIds&&(o.hashIds=this.popStack()),this.stringParams&&(o.hashTypes=this.popStack(),o.hashContexts=this.popStack()),i=this.popStack(),s=this.popStack(),(s||i)&&(s||(s="this.noop"),i||(i="this.noop"),o.fn=s,o.inverse=i);for(var h=e;h--;)r=this.popStack(),n[h]=r,this.trackIds&&(l[h]=this.popStack()),this.stringParams&&(u[h]=this.popStack(),a[h]=this.popStack());return this.trackIds&&(o.ids="["+l.join(",")+"]"),this.stringParams&&(o.types="["+u.join(",")+"]",o.contexts="["+a.join(",")+"]"),this.options.data&&(o.data="data"),o},setupParams:function(t,e,n,r){var i=this.objectLiteral(this.setupOptions(t,e,n));return r?(this.useRegister("options"),n.push("options"),"options="+i):(n.push(i),"")}};for(var u="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),l=r.RESERVED_WORDS={},h=0,c=u.length;c>h;h++)l[u[h]]=!0;return r.isValidJavaScriptVariableName=function(t){return!r.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},i=r}(r,n),p=function(t,e,n,r,i){var s,o=t,a=e,u=n.parser,l=n.parse,h=r.Compiler,c=r.compile,p=r.precompile,f=i,d=o.create,g=function(){var t=d();return t.compile=function(e,n){return c(e,n,t)},t.precompile=function(e,n){return p(e,n,t)},t.AST=a,t.Compiler=h,t.JavaScriptCompiler=f,t.Parser=u,t.parse=l,t};return o=g(),o.create=g,o["default"]=o,s=o}(s,o,l,h,c);return p}),n("templates",["handlebars"],function(t){return this.JST=this.JST||{},this.JST.lookup=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<form>\n  <div class="lookup inner-container">\n    <span>\n      <label for="zvelo-url-input">http://</label>\n    </span>\n    <span class="remaining">\n      <input type="text"\n             id="zvelo-url-input"\n             title="Enter a URL to lookup its categorization"\n             placeholder="zvelo.com (just start typing&hellip;)"\n             autocomplete="off"\n             spellcheck="false">\n    </span>\n  </div>\n  <div class="controls">\n    <button type="submit" class="btn btn-large btn-primary">Lookup</button>\n  </div>\n</form>\n'},useData:!0}),this.JST.modal=t.template({1:function(t,e,n,r){var i,s="function",o=e.helperMissing,a=this.escapeExpression;return" "+a((i=null!=(i=e["class"]||(null!=t?t["class"]:t))?i:o,typeof i===s?i.call(t,{name:"class",hash:{},data:r}):i))},3:function(){return'    <button type="button" class="close">×</button>\n'},5:function(t,e,n,r){var i,s="function",o=e.helperMissing,a=this.escapeExpression;return'    <button class="btn btn-primary">'+a((i=null!=(i=e.btn||(null!=t?t.btn:t))?i:o,typeof i===s?i.call(t,{name:"btn",hash:{},data:r}):i))+"</button>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,r){var i,s,o="function",a=e.helperMissing,u=this.escapeExpression,l='<div class="modal hide fade';return i=e["if"].call(t,null!=t?t["class"]:t,{name:"if",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),null!=i&&(l+=i),l+='">\n  <div class="modal-header">\n',i=e["if"].call(t,null!=t?t.close:t,{name:"if",hash:{},fn:this.program(3,r),inverse:this.noop,data:r}),null!=i&&(l+=i),l+="\n    <h3>"+u((s=null!=(s=e.header||(null!=t?t.header:t))?s:a,typeof s===o?s.call(t,{name:"header",hash:{},data:r}):s))+'</h3>\n  </div>\n  <div class="modal-body">\n    <p>',s=null!=(s=e.body||(null!=t?t.body:t))?s:a,i=typeof s===o?s.call(t,{name:"body",hash:{},data:r}):s,null!=i&&(l+=i),l+='</p>\n  </div>\n  <div class="modal-footer">\n',i=e["if"].call(t,null!=t?t.btn:t,{name:"if",hash:{},fn:this.program(5,r),inverse:this.noop,data:r}),null!=i&&(l+=i),l+"  </div>\n</div>\n"},useData:!0}),this.JST.report=t.template({1:function(t){var e=this.lambda,n=this.escapeExpression;return'        <option value="'+n(e(null!=t?t.id:t,t))+'">'+n(e(null!=t?t.name:t,t))+"</option>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,r){var i,s,o="function",a=e.helperMissing,u=this.escapeExpression,l='<form>\n  <div class="inner-container '+u((s=null!=(s=e.page||(null!=t?t.page:t))?s:a,typeof s===o?s.call(t,{name:"page",hash:{},data:r}):s))+'">\n    <p class="lead url">'+u((s=null!=(s=e.url||(null!=t?t.url:t))?s:a,typeof s===o?s.call(t,{name:"url",hash:{},data:r}):s))+'</p>\n\n    <div class="categories">\n      <select>\n        <option value="">-- Suggest a Category --</option>\n';return i=e.each.call(t,null!=t?t.categories:t,{name:"each",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),null!=i&&(l+=i),l+'      </select>\n    </div>\n  </div>\n\n  <div class="controls">\n    <button type="submit" class="btn btn-large btn-danger report">Report Miscategorization</button>\n    <button type="button" class="btn btn-large btn-primary lookup">Return to Lookup</button>\n  </div>\n</form>\n'},useData:!0}),this.JST.result=t.template({1:function(t,e,n,r){var i,s='    <div class="categories">\n';return i=e.each.call(t,null!=t?t.categories:t,{name:"each",hash:{},fn:this.program(2,r),inverse:this.noop,data:r}),null!=i&&(s+=i),s+"    </div>\n"},2:function(t){var e=this.lambda,n=this.escapeExpression;return'      <span class="category" title="'+n(e(t,t))+'">'+n(e(t,t))+"</span>\n"},4:function(){return'    <p class="uncategorized">\n    This URL has not yet been categorized. It has been submitted for classification.\n    </p>\n'},6:function(t,e,n,r){var i,s="function",o=e.helperMissing,a=this.escapeExpression;return'  <div class="reputation reputation'+a((i=null!=(i=e.reputationId||(null!=t?t.reputationId:t))?i:o,typeof i===s?i.call(t,{name:"reputationId",hash:{},data:r}):i))+'">\n    <div class="reputation-img-container">\n      <div class="aspect"></div>\n      <div class="img"></div>\n    </div>\n    <p title="'+a((i=null!=(i=e.reputation||(null!=t?t.reputation:t))?i:o,typeof i===s?i.call(t,{name:"reputation",hash:{},data:r}):i))+'">'+a((i=null!=(i=e.reputation||(null!=t?t.reputation:t))?i:o,typeof i===s?i.call(t,{name:"reputation",hash:{},data:r}):i))+"</p>\n  </div>\n"},8:function(){return'  <button class="btn btn-large btn-warning report" title="Report this URL as miscategorized">Miscategorized?</button>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(t,e,n,r){var i,s,o="function",a=e.helperMissing,u=this.escapeExpression,l='<div class="inner-container">\n  <div class="results">\n    <p class="lead url" title="'+u((s=null!=(s=e.url||(null!=t?t.url:t))?s:a,typeof s===o?s.call(t,{name:"url",hash:{},data:r}):s))+'">'+u((s=null!=(s=e.url||(null!=t?t.url:t))?s:a,typeof s===o?s.call(t,{name:"url",hash:{},data:r}):s))+"</p>\n\n";return i=e["if"].call(t,null!=t?t.reputationId:t,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(4,r),data:r}),null!=i&&(l+=i),l+="  </div>\n\n",i=e["if"].call(t,null!=t?t.reputationId:t,{name:"if",hash:{},fn:this.program(6,r),inverse:this.noop,data:r}),null!=i&&(l+=i),l+='</div>\n\n<div class="controls">\n  <button class="btn btn-large btn-primary lookup" title="Lookup another URL">Lookup Another URL</button>\n',i=e["if"].call(t,null!=t?t.reputationId:t,{name:"if",hash:{},fn:this.program(8,r),inverse:this.noop,data:r}),null!=i&&(l+=i),l+"</div>\n"},useData:!0}),this.JST}),function(t,e){function r(){for(y=!0,clearTimeout(l);u=v.pop();)u();g&&(e[p]="complete");for(var t;t=d.shift();)t()}function i(){if(!e.body)return!1;c||(c=e.createTextNode(""));try{return e.body.removeChild(e.body.appendChild(c)),c=h,!0}catch(t){return!1}}function s(){var t;return t=f[e[p]]&&i(),!y&&t&&r(),t}function o(){s(),y||(l=setTimeout(o,m))}var a,u,l,h,c,p="readyState",f={loaded:1,interactive:1,complete:1},d=[],g=e&&"string"!=typeof e[p],y=!1,m=10,v=[];a="addEventListener"in t?function(t,e){return t.addEventListener(e,s,!1),function(){t.removeEventListener(e,s,!1)}}:function(t,e){return t.attachEvent("on"+e,s),function(){t.detachEvent(e,s)}},e&&(s()||(v=[a(t,"load"),a(e,"readystatechange"),a(t,"DOMContentLoaded")],l=setTimeout(o,m))),n("domReady",[],function(){function t(t){y?t():d.push(t)}return t.then=t,t.amd=!0,t})}(this,this.document),function(){var t={}.hasOwnProperty;n("zvelonet/lib/semver",[],function(){var e,n,r,i,s,o,a,u,l,h,c,p,f,d,g,y,m,v,_,b,w,k,x,S,E,C,T,P,N,A,O,j;E="\\s*[v=]*\\s*([0-9]+)\\.([0-9]+)\\.([0-9]+)(-[0-9]+-?)?([a-zA-Z-+][a-zA-Z0-9-.:]*)?",o="^((<|>)?=?)s*("+E+")$|^$",j="[v=]*([0-9]+|x|X|\\*)(?:\\.([0-9]+|x|X|\\*)(?:\\.([0-9]+|x|X|\\*)([a-zA-Z-][a-zA-Z0-9-.:]*)?)?)?",O="((?:<|>)=?)?\\s*"+j,a="(?:~>?)",u=""+a+O,h={parse:new RegExp("^\\s*"+E+"\\s*$"),parsePackage:new RegExp("^\\s*([^/]+)[-@]("+E+")\\s*$"),parseRange:new RegExp("^\\s*("+E+")\\s+-\\s+("+E+")\\s*$"),validComparator:new RegExp("^"+o+"$"),parseXRange:new RegExp("^"+O+"$"),parseSpermy:new RegExp("^"+u+"$")},v=function(t){return(""+(t||"")).match(h.parse)},P=function(t){var e;return e=t,[e[1]||"",e[2]||"",e[3]||""].join(".")+(e[4]||"")+(e[5]||"")},C=/(<|>)?=?\s*\*/g,T="",e=new RegExp("((<|>)?=|<|>)\\s*("+E+"|"+j+")","g"),n="$1$3",k=function(t){return t.trim().replace(h.parseXRange,function(t,e,n,r,i){var s,o;return s=!n||"x"===n.toLowerCase()||"*"===n||!r||"x"===r.toLowerCase()||"*"===r||!i||"x"===i.toLowerCase()||"*"===i,o=t,e&&s?((!n||"*"===n||"x"===n.toLowerCase())&&(n=0),(!r||"*"===r||"x"===r.toLowerCase())&&(r=0),(!i||"*"===i||"x"===i.toLowerCase())&&(i=0),o=""+e+n+"."+r+"."+i+"-"):n&&"*"!==n&&"x"!==n.toLowerCase()?r&&"*"!==r&&"x"!==r.toLowerCase()?i&&"*"!==i&&"x"!==i.toLowerCase()||(o=">="+n+"."+r+".0- <"+n+"."+(+r+1)+".0-"):o=">="+n+".0.0- <"+(+n+1)+".0.0-":o="*",o})},x=function(t){return t.split(/\s+/).map(k).join(" ")},b=function(t){return t.trim().replace(h.parseSpermy,function(t,e,n,r,i,s){if(e)throw new Error("Using '"+e+"' with ~ makes no sense. Don't do it.");return n&&"x"!==n.toLowerCase()?r&&"x"!==r.toLowerCase()?i&&"x"!==i.toLowerCase()?(s=s||"-",">="+n+"."+r+"."+(i+s)+" <"+n+"."+(+r+1)+".0-"):">="+n+"."+r+".0- <"+n+"."+(+r+1)+".0-":">="+n+".0.0- <"+(+n+1)+".0.0-":""})},m=function(t){return null==t?-1:parseInt((t||"0").replace(/[^0-9]+/g,""),10)},c=function(t,e){var n,r,i,s;if(t=v(t),e=v(e),!t||!e)return!1;for(n=s=1;4>=s;n=++s){if(t[n]=m(t[n]),e[n]=m(e[n]),t[n]>e[n])return!0;if(t[n]!==e[n])return!1}return r=t[5]||"",i=e[5]||"",r===i?null:r?i?r>i:!1:!0},d=function(t,e){return c(e,t)},p=function(t,e){return!d(t,e)},g=function(t,e){return!c(t,e)},i=function(t,e){return null===c(t,e)},y=function(t,e){return null!==c(t,e)},r=function(t,e){var n;return n=c(t,e),null===n?0:n?1:-1},A=function(t){return"string"!=typeof t?null:v(t)&&t.trim().replace(/^[v=]+/,"")},_=">=$1 <=$7",N=function(t){var r;return r=(t||"").trim().replace(h.parseRange,_).replace(e,n).split(/\s+/).join(" ").split("||").map(function(t){return t.replace(new RegExp("("+a+")\\s+"),"$1").split(" ").map(x).map(b).map(w).join(" ").trim()}).map(function(t){return t.trim().split(/\s+/).filter(function(t){return t.match(h.validComparator)})}).filter(function(t){return t.length})},S=function(t,e){var n,r,s,o,a,u,l,h,p;if(t=A(t),!t)return!1;for(e=N(e),u=0,h=e.length;h>u;u++){for(r=e[u],s=!1,l=0,p=r.length;p>l&&(o=r[l],n=function(){switch(o.charAt(0)){case">":return c;case"<":return d;default:return!1}}(),i=o.charAt("="===!!n),a=!!i+!!n,n||(i=!0),o=o.substr(a),o=""===o?o:A(o),s=""===o||i&&o===t||n&&n(t,o),s);l++);if(s)return!0}return!1},w=function(t){return t.trim().replace(C,T)},s={expressions:h,rangeReplace:_,compare:r,satisfies:S,replaceStars:w,toComparators:N,eq:i,neq:y,gt:c,gte:p,lt:d,lte:g,rcompare:function(t,e){return r(e,t)},clean:function(t){return t=v(t),t?P(t):t},validPackage:function(t){return"string"!=typeof t?null:t.match(h.parsePackage)&&t.trim()},validRange:function(t){var e;return t=w(t),e=N(t),0===e.length?null:e.map(function(t){return t.join(" ")}).join("||")},maxSatisfying:function(t,e){return t.filter(function(t){return S(t,e)}).sort(r).pop()||null},inc:function(t,e){var n,r,i,s,o;if(t=v(t),!t)return null;if(s={major:1,minor:2,patch:3,build:4},i=s[e],null==i)return null;for(n=m(t[i]),t[i]=-1===n?1:n+1,r=o=i;4>=i?4>=o:o>=4;r=4>=i?++o:--o)-1!==m(t[r])&&(t[r]="0");return t[4]&&(t[4]="-"+t[4]),t[5]="",P(t)},cmp:function(t,e,n){switch(e){case">":return c(t,n);case"<":return d(t,n);case">=":return p(t,n);case"<=":return g(t,n);case"==":return i(t,n);case"!=":return y(t,n);case"is":return t===n;case"===":return t===n;case"isnt":return t!==n;case"!==":return t!==n;default:throw new Error("Y U NO USE VALID COMPARATOR!? "+e)}}};for(f in h)t.call(h,f)&&(l=h[f],s[f]=function(t){return(""+(t||"")).match(l)});return s})}.call(this),function(){var t;t=this,n("zvelonet/lib/log",[],function(){return function(){return t.console?console.log(Array.prototype.slice.call(arguments)):void 0}})}.call(this),function(){var t;t="zvelo",n("zvelonet/lib/storage",["./log"],function(e){var n;return n={makeKey:function(e,n){if(null==e)throw new Error("storage cannot use unspecified index");return null==n&&(n=t),""+n+"."+e},inUse:function(){return null!=("undefined"!=typeof window&&null!==window?window.localStorage:void 0)?!0:!1},write:function(t,r,i){var s,o;if(!n.inUse())return!1;o=n.makeKey(t,i),e("storage: writing "+o);try{return localStorage.setItem(o,JSON.stringify(r)),!0}catch(a){return s=a,s===QUOTA_EXCEEDED_ERR&&e("storage: localStorage quota exceeded"),!1}},read:function(t,r,i){var s,o,a,u;if(!n.inUse())return r;if(o=n.makeKey(t,i),a=localStorage.getItem(o),null==a&&null!=r)return e("storage: "+o+" was missing, storing default"),n.write(t,r,i),r;try{return u=JSON.parse(a),e("storage: read "+o),u}catch(l){return s=l,r}},"delete":function(t,e){var r;if(n.inUse())return r=n.makeKey(t,e),localStorage.removeItem(r)}}})}.call(this),function(t){function e(t,e,n){for(var r=(n||0)-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function r(t,n){var r=typeof n;if(t=t.cache,"boolean"==r||null==n)return t[n];"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:I+n;return t=t[r]||(t[r]={}),"object"==r?t[i]&&e(t[i],n)>-1?0:-1:t[i]?0:-1}function i(t){var e=this.cache,n=typeof t;if("boolean"==n||null==t)e[t]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?t:I+t,i=e[n]||(e[n]={});"object"==n?(i[r]||(i[r]=[])).push(t)==this.array.length&&(e[n]=!1):i[r]=!0}}function s(t){var e=-1,n=t.length,r=a();r["false"]=r["null"]=r["true"]=r.undefined=!1;var s=a();for(s.array=t,s.cache=r,s.push=i;++e<n;)s.push(t[e]);return r.object===!1?(h(s),null):s}function o(){return M.pop()||[]}function a(){return R.pop()||{args:"",array:null,bottom:"",cache:null,"false":!1,firstArg:"",init:"",loop:"","null":!1,number:null,object:null,push:null,shadowedProps:null,string:null,top:"","true":!1,undefined:!1,useHas:!1,useKeys:!1}}function u(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function l(t){t.length=0,M.length<D&&M.push(t)}function h(t){var e=t.cache;e&&h(e),t.array=t.cache=t.object=t.number=t.string=null,R.length<D&&R.push(t)}function c(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,s=Array(0>i?0:i);++r<i;)s[r]=t[e+r];return s}function p(){}function f(){var t=a();t.shadowedProps=$,t.array=t.bottom=t.loop=t.top="",t.init="iterable",t.useHas=!0,t.useKeys=!!Pe;for(var e,n=0;e=arguments[n];n++)for(var r in e)t[r]=e[r];var i=t.args;t.firstArg=/^[^,]+/.exec(i)[0];var s=Function("errorClass, errorProto, hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+i+") {\n"+ke(t)+"\n}");return h(t),s(J,ne,ue,y,Ce,x,Pe,p,re,G,be,Q,ie,he)}function d(){var t=(t=p.indexOf)===T?e:t;return t}function g(t){return function(e,n,r,i){return"boolean"!=typeof n&&null!=n&&(i=r,r=i&&i[n]===e?j:n,n=!1),null!=r&&(r=p.createCallback(r,i)),t(e,n,r,i)}}function y(t){return he.call(t)==q}function m(t,e,n,r,i,s){var a=t;if("boolean"!=typeof e&&null!=e&&(r=n,n=e,e=!1),"function"==typeof n){if(n="undefined"==typeof r?n:p.createCallback(n,r,1),a=n(a),"undefined"!=typeof a)return a;a=t}var h=w(a);if(h){var f=he.call(a);if(!Z[f]||!we.nodeClass&&u(a))return a;var d=Ce(a)}if(!h||!e)return h?d?c(a):Ae({},a):a;var g=_e[f];switch(f){case F:case V:return new g(+a);case W:case Q:return new g(a);case Y:return g(a.source,z.exec(a))}var y=!i;i||(i=o()),s||(s=o());for(var v=i.length;v--;)if(i[v]==t)return s[v];return a=d?g(a.length):{},d&&(ue.call(t,"index")&&(a.index=t.index),ue.call(t,"input")&&(a.input=t.input)),i.push(t),s.push(a),(d?Ne:je)(t,function(t,r){a[r]=m(t,e,n,j,i,s)}),y&&(l(i),l(s)),a}function v(t){var e=!0;if(!t)return e;var n=he.call(t),r=t.length;return n==B||n==Q||(we.argsClass?n==q:y(t))||n==X&&"number"==typeof r&&b(t.splice)?!r:(je(t,function(){return e=!1}),e)}function _(t,e,n,r,i,s){var a=n===H;if("function"==typeof n&&!a){n=p.createCallback(n,r,2);var h=n(t,e);if("undefined"!=typeof h)return!!h}if(t===e)return 0!==t||1/t==1/e;var c=typeof t,f=typeof e;if(t===t&&(!t||"function"!=c&&"object"!=c)&&(!e||"function"!=f&&"object"!=f))return!1;if(null==t||null==e)return t===e;var d=he.call(t),g=he.call(e);if(d==q&&(d=X),g==q&&(g=X),d!=g)return!1;switch(d){case F:case V:return+t==+e;case W:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case Y:case Q:return t==String(e)}var m=d==B;if(!m){if(ue.call(t,"__wrapped__ ")||ue.call(e,"__wrapped__"))return _(t.__wrapped__||t,e.__wrapped__||e,n,r,i,s);if(d!=X||!we.nodeClass&&(u(t)||u(e)))return!1;var v=!we.argsObject&&y(t)?Object:t.constructor,w=!we.argsObject&&y(e)?Object:e.constructor;if(v!=w&&!(b(v)&&v instanceof v&&b(w)&&w instanceof w))return!1}var k=!i;i||(i=o()),s||(s=o());for(var x=i.length;x--;)if(i[x]==t)return s[x]==e;var S=0;if(h=!0,i.push(t),s.push(e),m){if(x=t.length,S=e.length,h=S==t.length,!h&&!a)return h;for(;S--;){var E=x,C=e[S];if(a)for(;E--&&!(h=_(t[E],C,n,r,i,s)););else if(!(h=_(t[S],C,n,r,i,s)))break}return h}return Oe(e,function(e,o,a){return ue.call(a,o)?(S++,h=ue.call(t,o)&&_(t[o],e,n,r,i,s)):void 0}),h&&!a&&Oe(t,function(t,e,n){return ue.call(n,e)?h=--S>-1:void 0}),k&&(l(i),l(s)),h}function b(t){return"function"==typeof t}function w(t){return!(!t||!G[typeof t])}function x(t){return"string"==typeof t||he.call(t)==Q}function S(t,e,n){if(e=p.createCallback(e,n),!Ce(t)){var r;return Ne(t,function(t,n,i){return e(t,n,i)?(r=t,!1):void 0}),r}for(var i=-1,s=t.length;++i<s;){var o=t[i];if(e(o,i,t))return o}}function E(t,e,n){if(e&&"undefined"==typeof n&&Ce(t))for(var r=-1,i=t.length;++r<i&&e(t[r],r,t)!==!1;);else Ne(t,e,n);return t}function C(t){var e=t?t.length:0;return"number"==typeof e?e:Pe(t).length
}function T(t,n,r){if("number"==typeof r){var i=t?t.length:0;r=0>r?ge(0,i+r):r||0}else if(r){var s=P(t,n);return t[s]===n?s:-1}return t?e(t,n,r):-1}function P(t,e,n,r){var i=0,s=t?t.length:i;for(n=n?p.createCallback(n,r,1):O,e=n(e);s>i;){var o=i+s>>>1;n(t[o])<e?i=o+1:s=o}return i}function N(t){return Ce(t)||(arguments[0]=t?ye.call(t):ee),Me(oe.apply(ee,arguments))}function A(t,e,n){if(null==t)return O;var r=typeof t;if("function"!=r){if("object"!=r)return function(e){return e[t]};var i=Pe(t);return function(e){for(var n=i.length,r=!1;n--&&(r=_(e[i[n]],t[i[n]],H)););return r}}return"undefined"==typeof e||U&&!U.test(ae.call(t))?t:1===n?function(n){return t.call(e,n)}:2===n?function(n,r){return t.call(e,n,r)}:4===n?function(n,r,i,s){return t.call(e,n,r,i,s)}:function(n,r,i){return t.call(e,n,r,i)}}function O(t){return t}var j,M=[],R=[],H={},I=+new Date+"",L=75,D=40,z=/\w*$/,U=(U=/\bthis\b/)&&U.test(function(){return this})&&U,$=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],q="[object Arguments]",B="[object Array]",F="[object Boolean]",V="[object Date]",J="[object Error]",K="[object Function]",W="[object Number]",X="[object Object]",Y="[object RegExp]",Q="[object String]",Z={};Z[K]=!1,Z[q]=Z[B]=Z[F]=Z[V]=Z[W]=Z[X]=Z[Y]=Z[Q]=!0;var G={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},te=G[typeof global]&&global;!te||te.global!==te&&te.window!==te||(t=te);var ee=[],ne=Error.prototype,re=Object.prototype,ie=String.prototype,se=(t._,RegExp("^"+String(re.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$")),oe=(Math.ceil,t.clearTimeout,ee.concat),ae=(Math.floor,Function.prototype.toString),ue=re.hasOwnProperty,le=(ee.push,re.propertyIsEnumerable),he=(t.setTimeout,re.toString),ce=se.test(ce=he.bind)&&ce,pe=se.test(pe=Object.create)&&pe,fe=se.test(fe=Array.isArray)&&fe,de=(t.isFinite,t.isNaN,se.test(de=Object.keys)&&de),ge=Math.max,ye=(Math.min,Math.random,ee.slice),me=se.test(t.attachEvent),ve=ce&&!/\n|true/.test(ce+me),_e={};_e[B]=Array,_e[F]=Boolean,_e[V]=Date,_e[K]=Function,_e[X]=Object,_e[W]=Number,_e[Y]=RegExp,_e[Q]=String;var be={};be[B]=be[V]=be[W]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},be[F]=be[Q]={constructor:!0,toString:!0,valueOf:!0},be[J]=be[K]=be[Y]={constructor:!0,toString:!0},be[X]={constructor:!0},function(){for(var t=$.length;t--;){var e=$[t];for(var n in be)ue.call(be,n)&&!ue.call(be[n],e)&&(be[n][e]=!1)}}();var we=p.support={};!function(){var t=function(){this.x=1},e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments);we.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),we.argsClass=y(arguments),we.enumErrorProps=le.call(ne,"message")||le.call(ne,"name"),we.enumPrototypes=le.call(t,"prototype"),we.fastBind=ce&&!ve,we.nonEnumArgs=0!=n,we.nonEnumShadows=!/valueOf/.test(e),we.unindexedChars="x"[0]+Object("x")[0]!="xx";try{we.nodeClass=!(he.call(document)==X&&!({toString:0}+""))}catch(r){we.nodeClass=!0}}(1);var ke=function(t){var e="var index, iterable = "+t.firstArg+", result = "+t.init+";\nif (!iterable) return result;\n"+t.top+";";t.array?(e+="\nvar length = iterable.length; index = -1;\nif ("+t.array+") {  ",we.unindexedChars&&(e+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),e+="\n  while (++index < length) {\n    "+t.loop+";\n  }\n}\nelse {  "):we.nonEnumArgs&&(e+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+t.loop+";\n    }\n  } else {  "),we.enumPrototypes&&(e+="\n  var skipProto = typeof iterable == 'function';\n  "),we.enumErrorProps&&(e+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var n=[];if(we.enumPrototypes&&n.push('!(skipProto && index == "prototype")'),we.enumErrorProps&&n.push('!(skipErrorProps && (index == "message" || index == "name"))'),t.useHas&&t.useKeys)e+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",n.length&&(e+="    if ("+n.join(" && ")+") {\n  "),e+=t.loop+";    ",n.length&&(e+="\n    }"),e+="\n  }  ";else if(e+="\n  for (index in iterable) {\n",t.useHas&&n.push("hasOwnProperty.call(iterable, index)"),n.length&&(e+="    if ("+n.join(" && ")+") {\n  "),e+=t.loop+";    ",n.length&&(e+="\n    }"),e+="\n  }    ",we.nonEnumShadows){for(e+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;7>k;k++)e+="\n    index = '"+t.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",t.useHas||(e+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),e+=") {\n      "+t.loop+";\n    }      ";e+="\n  }    "}return(t.array||we.nonEnumArgs)&&(e+="\n}"),e+=t.bottom+";\nreturn result"},xe={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},Se={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",array:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},Ee={top:"if (!objectTypes[typeof iterable]) return result;\n"+Se.top,array:!1};we.argsClass||(y=function(t){return t?ue.call(t,"callee"):!1});var Ce=fe||function(t){return t?"object"==typeof t&&he.call(t)==B:!1},Te=f({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),Pe=de?function(t){return w(t)?we.enumPrototypes&&"function"==typeof t||we.nonEnumArgs&&t.length&&y(t)?Te(t):de(t):[]}:Te,Ne=f(Se),Ae=f(xe,{top:xe.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Oe=f(Se,Ee,{useHas:!1}),je=f(Se,Ee);b(/x/)&&(b=function(t){return"function"==typeof t&&he.call(t)==K});var Me=g(function(t,n,i){var a=-1,u=d(),c=t?t.length:0,p=[],f=!n&&c>=L&&u===e,g=i||f?o():p;if(f){var y=s(g);y?(u=r,g=y):(f=!1,g=i?g:(l(g),p))}for(;++a<c;){var m=t[a],v=i?i(m,a,t):m;(n?!a||g[g.length-1]!==v:u(g,v)<0)&&((i||f)&&g.push(v),p.push(m))}return f?(l(g.array),h(g)):i&&l(g),p});p.assign=Ae,p.createCallback=A,p.forEach=E,p.forIn=Oe,p.forOwn=je,p.keys=Pe,p.union=N,p.uniq=Me,p.each=E,p.extend=Ae,p.unique=Me,p.clone=m,p.find=S,p.identity=O,p.indexOf=T,p.isArguments=y,p.isArray=Ce,p.isEmpty=v,p.isEqual=_,p.isFunction=b,p.isObject=w,p.isString=x,p.size=C,p.sortedIndex=P,p.detect=S,p.findWhere=S,p.VERSION="1.3.1","function"==typeof n&&"object"==typeof n.amd&&n.amd&&n("zvelonet/lib/lodash",[],function(){return p})}(this),function(){var t={}.hasOwnProperty;n("zvelonet/lib/url",["./lodash","./log"],function(e,n){var r,i,s,o,a,u,l;return o="://",r=["source","scheme","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],u=function(){var t,e,n,r,i,s,o,a,u,l,h,c,p,f,d,g,y,m,v,_,b,w,k,x;return e="[^:@]",_="(?!"+e+"+:[^:@/]*@)",m="([^:/?#.]+)",v="(?:"+_+m+":)",b="(?://)",x="("+e+"*)",h=x,w="("+x+":?"+h+")",k="(?:"+w+"?@)",l="([^:/?#]*)",p="(\\d*)",f="(?::"+p+")",t="("+k+"?"+l+f+"?)",r="(?:[?#]|$)",i="(?![^?#/]*\\.[^?#/.]+"+r+")",s="(?:[^?#]"+i+")",n="(/"+s+"*/?)",o="([^?#/]*)",c="("+n+"?"+o+")",d="([^#]*)",g="(?:\\?"+d+")",a="(.*)",u="(?:#"+a+")",y="("+c+g+"?"+u+"?)",new RegExp("^"+(""+v+"?")+(""+b+"?")+t+y)},l=function(){var t,e,n;return e="(?:^|&|;)",t="([^&=;]*)",n="([^&;]*)",new RegExp(""+e+t+"=?"+n,"g")},i=u(),s=l(),a=function(){function a(t){var e,n,r,i,s;if(this._origUrl=t,a.isUrl(this._origUrl))throw new Error("The Url class has no copy constructor");if("string"!=typeof this._origUrl)throw new Error("Cannot create Url object from "+typeof this._origUrl);if(e=a.parse(this._origUrl),null==e||(null!=(r=e.attr)&&null!=(i=r.host)?!i.length:!0))throw new Error('Could not parse url: "'+this._origUrl+'"');s=e.attr,this.scheme=s.scheme,this.host=s.host,this.path=s.path,n=a.getScheme(this.scheme),this.port=parseInt(e.attr.port,10),isNaN(this.port)&&(this.port=n.port),this.pathParts=e.seg.path,this.query=e.query,this.url=this.toString()}return a.TYPE={HOST:0,PATH:1,SCHEME_PORT:2,QUERY:3},a.SCHEME={HTTP:{id:0,name:"http",port:80},HTTPS:{id:1,name:"https",port:443},FTP:{id:2,name:"ftp",port:21}},a.getScheme=function(n){var r,i;i=a.SCHEME;for(r in i)if(t.call(i,r)){if("string"==typeof n&&n.toLowerCase()===a.SCHEME[r].name)return e.clone(a.SCHEME[r]);if("number"==typeof n&&n===a.SCHEME[r].id)return e.clone(a.SCHEME[r])}},a.decodeAll=function(t){var e,n,r;n=t;try{for(;n!==e;)e=decodeURIComponent(n)}catch(i){return r=i,n}return e},a.parse=function(t){var n,o,u,l,h,c,p,f,d,g,y,m,v,_,b,w;if(null==a.parse.cache&&(a.parse.cache={}),"string"==typeof t){if(t in a.parse.cache)return a.parse.cache[t];if(g={attr:{},seg:{}},t=t.replace(/[\t\r\n]/g,"").replace(/(#.*$)/,""),o=t.indexOf("?"),-1!==o&&(c=t.substring(o),t=t.substring(0,o)),d=a.decodeAll(t),null!=d){for(p=i.exec(a.prependHttp(d)),n=y=_=r.length-1;0>=_?0>=y:y>=0;n=0>=_?++y:--y)g.attr[r[n]]=p[n];if(null!=g.attr.host){for(null!=g.attr.query&&g.attr.query.replace(s,function(t,n,r){var i,s;return null==g.query&&(g.query=[]),s={key:n,value:r},i=e.sortedIndex(g.query,s,function(t){var e;return e=t.key,null!=t.value&&(e+=":"+t.value),e}),g.query.splice(i,0,s)}),g.attr.host=encodeURIComponent(g.attr.host).replace(/^\.\.*/,"").replace(/\.\.*$/,"").replace(/\.\.\.*/g,".").toLowerCase(),g.seg.path=[],l=null!=g.attr.path?g.attr.path:"/",h=l.trim().split("/"),m=0,v=h.length;v>m;m++)u=h[m],u.length&&"."!==u&&(".."===u?g.seg.path.pop():u&&(u=encodeURI(u).replace("#","%23"),g.seg.path.push(u)));if(g.attr.path=g.seg.path.length?"/"+g.seg.path.join("/"):"/",(null!=(b=g.attr.fragment)?b.length:void 0)&&(l+="#"+g.attr.fragment),f=(null!=(w=g.attr.scheme)?w.length:void 0)?a.getScheme(g.attr.scheme.trim()):a.SCHEME.HTTP.name,null!=f)return g.attr.schemea=f.name,null==g.attr.port&&(g.attr.port=f.port),a.parse.cache[t]=g,g}}}},a.prependHttp=function(t){var e,n;if(null!=t)return e=t.indexOf(o),-1===e?""+a.SCHEME.HTTP.name+o+t:0===e?""+a.SCHEME.HTTP.name+t:(n=t.indexOf("/"),-1===n||e>n?""+a.SCHEME.HTTP.name+o+t:t)},a.isUrl=function(t){return t instanceof a},a._queryToStr=function(t){var e,n,r,i;if("string"==typeof t&&t)return"?"+t;if(Array.isArray(t&&t.length)){for(r=0,i=t.length;i>r;r++)e=t[r],"undefined"!=typeof n&&null!==n?n+="&":n="?",n+=""+e.key,null!=e.value&&(n+="="+e.value);return n}return""},a.build=function(t,e,n,r,i){var s;if(null!=e&&e){if(t=a.getScheme(t?t:"http"),s=""+t.name+o,Array.isArray(e)&&e.length)s+=e.join(".");else{if("string"!=typeof e||!e.length)return;s+=e}return null!=n&&"number"==typeof n&&t.port!==n&&(s+=":"+n),Array.isArray(r)?r.length&&(s+="/"+r.join("/")):s+="string"==typeof r?r:"/",s+=a._queryToStr(i),a.factory(s)}},a.factory=function(t){var e,r;if(a.isUrl(t))return t;try{if("string"==typeof t)return new a(t)}catch(i){return r=i,void n("Url Error: "+r.message)}return e=["Cannot create Url object from "+typeof t],null!=t&&e.push(t),n.apply(this,e)},a.hostUrl=function(t){var e;return e=a.factory(t),a.factory(""+e.scheme+"://"+e.host+":"+e.port+"/")},a.sort=function(t,e){return t=a.factory(t),e=a.factory(e),null==t||null==e?0:t.equals(e)?0:t.lessThan(e)?-1:1},a.prototype._parentHost=function(){var t;return t=this.host.split("."),t.length<2?void 0:(t.shift(),t.join("."))},a.prototype._hostParent=function(){var t,e,n;return t=this._parentHost(),n=this.scheme,e=this.port,null!=t||n===a.SCHEME.HTTP.name&&e===a.SCHEME.HTTP.port||(t=this.host,n=a.SCHEME.HTTP.name,e=a.SCHEME.HTTP.port),null!=t?a.build(n,t,e,this.path,this.query):void 0},a.prototype._parentPath=function(){var t;if(this.path&&"/"!==this.path)return this.pathParts.length<=1?"/":(t=e.clone(this.pathParts),t.pop(),"/"+t.join("/"))},a.prototype._pathParent=function(){var t;return(t=this._parentPath())?a.build(this.scheme,this.host,this.port,t,this.query):void 0},a.prototype._queryParent=function(){var t,n;if(null!=(n=this.query)?n.length:void 0)return t=e.clone(this.query),t.pop(),a.build(this.scheme,this.host,this.port,this.path,t)},a.prototype._parentHosts=function(){var t,e;if(null!=this._parentHostsCache)return this._parentHostsCache;for(this._parentHostsCache=[],e=this,t=e.host;t&&(this._parentHostsCache.push(t),e=a.factory(t),null!=e);)t=e._parentHost();return this._parentHostsCache},a.prototype._portLessThan=function(t){var e;return e=a.factory(t),null==e?!1:this.port===e.port?!1:this.port===a.SCHEME.HTTP.port?!0:e.port===a.SCHEME.HTTP.port?!1:this.port<e.port},a.prototype._schemeLessThan=function(t){var e;return e=a.factory(t),null==e?!1:this.scheme===e.scheme?!1:this.scheme===a.SCHEME.HTTP.name?!0:e.scheme===a.SCHEME.HTTP.name?!1:this.scheme<e.scheme},a.prototype._hostLessThan=function(t){var e,n,r,i,s,o,u,l,h,c;if(l=a.factory(t),null==l)return!1;if(this.host===l.host)return!1;if(u=this._parentHosts().reverse(),r=l._parentHosts().reverse(),u.length!==r.length)return u.length<r.length;for(i=h=0,c=u.length;c>h;i=++h){if(s=u[i],e=r[i],o=s.split(".").length,n=e.split(".").length,o!==n)return n>o;if(s!==e)return e>s}return!1},a.prototype._queryLessThan=function(t){var e,n,r,i,s,o,u;if(r=a.factory(t),null==r)return!1;if(null==this.query&&null!=r.query)return!0;if(null==r.query)return!1;if(this.query.length!==r.query.length)return this.query.length<r.query.length;for(u=this.query,e=s=0,o=u.length;o>s;e=++s){if(n=u[e],i=r.query[e],n.key!==i.key)return n.key<i.key;if(null==n.value&&null!=i.value)return!0;if(null==i.value)return!1;if(n.value!==i.value)return n.value<i.value}return!1},a.prototype.parent=function(){var t;return null!=(t=this._queryParent())?t:null!=(t=this._pathParent())?t:this._hostParent()},a.prototype.toString=function(t){var e,n;return n="",t||null==this.scheme||(e=a.getScheme(this.scheme),n=""+e.name+o),n+=this.host,t||this.port===e.port||(n+=":"+this.port),null!=this.path&&(n+=this.path),t||null==this.query||(n+=a._queryToStr(this.query)),n},a.prototype.valueOf=function(){return this.toString()},a.prototype.toJSON=function(){return this._origUrl},a.prototype.parents=function(){var t,e;if(null!=this._parentsCache)return this._parentsCache;for(this._parentsCache=[],t=this;t;)this._parentsCache.unshift(t),t=t.parent();return(this.scheme!==a.SCHEME.HTTP.name||this.port!==a.SCHEME.HTTP.port)&&(e=a.factory(""+this.host+this.path),null!=e&&(this._parentsCache=e.parents().concat(this._parentsCache))),this._parentsCache},a.prototype.forEachParent=function(t){var e,n,r,i,s,o;for(s=this.parents(),o=[],e=r=0,i=s.length;i>r&&(n=s[e],t(n,e===parents.length-1)!==!1);e=++r)o.push(void 0);return o},a.prototype.parts=function(){var t,e,n,r,i,s,o,u,l,h,c,p,f;if(null!=this._partsCache)return this._partsCache;for(this._partsCache=[],e=this.host.split("."),i=this.path.split("/"),s=a.getScheme(this.scheme),i[0].length||i.shift(),o=0,h=e.length;h>o;o++)t=e[o],t&&this._partsCache.unshift({type:a.TYPE.HOST,part:t});for(this._partsCache.push({type:a.TYPE.SCHEME_PORT,part:this.port+"_"+s.id}),u=0,c=i.length;c>u;u++)r=i[u],r&&this._partsCache.push({type:a.TYPE.PATH,part:r});if(null!=this.query)for(f=this.query,l=0,p=f.length;p>l;l++)n=f[l],this._partsCache.push({type:a.TYPE.QUERY,part:n});return this._partsCache},a.prototype.forEachPart=function(t){var e,n,r,i,s,o;for(r=this.parts(),o=[],e=i=0,s=r.length;s>i&&(n=r[e],t(r[e],e===r.length-1)!==!1);e=++i)o.push(void 0);return o},a.prototype.cacheUrls=function(){var t,e;if(null!=this._cacheUrlsCache)return this._cacheUrlsCache;for(this._cacheUrlsCache=[],e=this;null!=e;)this._cacheUrlsCache.unshift(e),e=e._hostParent();return this.scheme!==a.SCHEME.HTTP.name&&(t=a.factory(""+this.host+this.path),null!=t&&(this._cacheUrlsCache=this._cacheUrlsCache.concat(t.cacheUrls()))),this._cacheUrlsCache},a.prototype.forEachCacheUrl=function(t){var e,n,r,i,s,o;for(n=this.cacheUrls(),o=[],r=i=0,s=n.length;s>i&&(e=n[r],t(e,r===n.length-1)!==!1);r=++i)o.push(void 0);return o},a.prototype.equals=function(t,e){var n;return n=a.factory(t),n?null==e||e?n.url===this.url:n.url.toLowerCase()===this.url.toLowerCase():!1},a.prototype.isChildOf=function(t,n){var r,i;return i=a.factory(t),r=e.find(this.parents(),function(t){return t.equals(i,n)}),null!=r},a.prototype.isCacheChildOf=function(t,e){var n,r;return r=a.factory(t),n=!1,this.forEachCacheUrl(function(t){return t.isChildOf(r,e)?(n=!0,!1):!0}),n},a.prototype.lessThan=function(t){var e;return e=a.factory(t),this.equals(e)?!1:this.host!==e.host?this._hostLessThan(e):this.scheme!==e.scheme?this._schemeLessThan(e):this.port!==e.port?this._portLessThan(e):this.path!==e.path?this.path<e.path:this._queryLessThan(e)},a}()})}.call(this),function(){var t={}.hasOwnProperty;n("zvelonet/lib/urlnode",["./lodash","./log","./url"],function(e,n,r){var i,s;return i=!0,s=function(){function s(e){var n,r,i,o,a,u,l,h;if(this._authoritative=!1,null!=e&&(null!=e.d&&(this.data=e.d),null!=e.a&&e.a&&(this._authoritative=!0),null!=e.n&&this.setExpiration(e.n),null!=e.c)){h=e.c;for(u in h)if(t.call(h,u)){i=h[u];for(o in i)t.call(i,o)&&(r=i[o],n=new s(r),n._type=function(){switch(typeof u){case"number":return u;case"string":return parseInt(u,10);default:throw new Error("UrlNode child has invalid type: "+u)}}(),n._part=o,n._parent=this,null==this._children&&(this._children={}),a=null!=(l=this._children)[u]?l[u]:l[u]={},a[o]=n)}}}return s.cacheTime=864e5,s.isUrlNode=function(t){return t instanceof s},s.prototype.unset=function(){return delete this.data,delete this._time,delete this._authoritative},s.prototype.isSet=function(){return null!=this.data&&!this.expired()},s.prototype.nodeForEach=function(e,n){var r,s,o,a,u,l,h;if(s=null!=n&&n?this:this.getRoot(),e.call(s)!==!1){l=s._children,h=[];for(u in l)t.call(l,u)&&(a=l[u],h.push(function(){var n;n=[];for(o in a)t.call(a,o)&&(r=a[o],n.push(r.nodeForEach(e,i)));return n}()));return h}},s.prototype.size=function(){var t;return t=0,this.nodeForEach(function(){return this.isSet()?t+=1:void 0}),t},s.prototype.expire=function(){var t;return t=!1,this.nodeForEach(function(){return this.expired()?(n("clearing "+this.url()+" because it has expired"),this.unset(),this.prune(i),t=!0):void 0}),t&&this.prune(),t},s.prototype.hasChildren=function(){var n,r,i;i=this._children;for(r in i)if(t.call(i,r)&&(n=i[r],!e.isEmpty(n)))return!0;return!1},s.prototype.isRoot=function(){return!(null!=this._parent||null!=this._part||null!=this._type)},s.prototype.prune=function(r){var s,o,a,u,l,h,c,p;r=null!=r&&r?!0:!1,a=r?this:this.getRoot(),h=!r,s=!1,p=a._children;for(c in p)if(t.call(p,c))if(l=p[c],e.isEmpty(l))delete a._children[c],s=!0;else for(u in l)t.call(l,u)&&(o=l[u],o.prune(i)&&(s=!0));if(a.isSet()||a.hasChildren()||a.isRoot()||(n("pruning "+a.url()),s=!0,h=!1,a.rm()),h)for(;a.prune(i););return s},s.prototype.set=function(t,i,o,a){var u,l,h;if(null==i)throw new Error("not storing url without any data: "+t);if(h=r.factory(t),!h)throw new Error("not storing invalid url: "+t);return u=this.getRoot(),o=o?!0:!1,n("storing: "+h+" (authoritative: "+o+")"),l=void 0,h.forEachPart(function(t,n){var r,h,c,p;return"string"==typeof t.part&&(t.part=t.part.toLowerCase()),u.hasChild(t)?u=u._children[t.type][t.part]:(r=new s,r._parent=u,r._part=t.part,r._type=t.type,null==u._children&&(u._children={}),h=null!=(c=u._children)[p=t.type]?c[p]:c[p]={},h[t.part]=r,u=r),n?(a||u.setExpiration(),u._authoritative=o,u.data=e.clone(i),l=u):void 0}),l},s.prototype.getRoot=function(){var t;if(null!=this._rootNode)return this._rootNode;for(t=this;!t.isRoot();)t=t._parent;return this._rootNode=t,this._rootNode},s.prototype.hasChild=function(t){var e;if(null!=this._children&&t.type in this._children&&(e=t.part.toLowerCase(),e in this._children[t.type]))return this._children[t.type][e]},s.prototype.get=function(t,e){var i,s,o;if(o=r.factory(t),!o)throw new Error("not searching for invalid url: "+t);if(n("searching for: "+o),s=this.getRoot(),i=void 0,o.forEachCacheUrl(function(t){var r;return r=s,n("  using url: "+t),t.forEachPart(function(s,a){return r=r.hasChild(s),null==r?(n("      walk break, no child: "+s.part),!1):e&&r.url().equals(o,!1)?(n("    walk found exact url: "+r.url()),i=r,!1):!e&&r.isSet()&&r.isAuthoritativeFor(o)?(n("    walk hit:  "+r.url()),i=r,!1):(n("    walk miss: "+r.url()),a?n("    walk end: "+t):void 0)}),null!=i?!1:void 0}),null==i)n("miss: "+o);else if(i.isSet())n("hit: "+i.url()+" => "+o);else{if(!e)throw new Error("unknown result for: "+o+", "+i);n("miss, returning exact url: "+i+" => "+o)}return i},s.prototype.url=function(){var t,e,n,i,s,o,a,u;if(null!=this._url)return this._url;if(!this.isRoot()){for(e=this,o=i=void 0,t=[],n=[],s=[];null!=(null!=e?e._type:void 0);){switch(e._type){case r.TYPE.HOST:t.push(e._part);break;case r.TYPE.PATH:n.unshift(e._part);break;case r.TYPE.QUERY:s.unshift(e._part);break;case r.TYPE.SCHEME_PORT:if(u=e._part.split("_"),i=u[0],a=u[1],o=r.getScheme(parseInt(a,10)),null==o)throw new Error("invalid scheme: "+e._part);o=o.name;break;default:throw new Error("unknown node type when building url: "+e._type)}e=e._parent}return this._url=r.build(o,t,i,n,s),this._url}},s.prototype.rm=function(){return null!=this._parent?delete this._parent._children[this._type][this._part]:void 0},s.prototype.toJSON=function(e){var n,r,i,s,o,a,u,l,h;i=null!=e&&e?this:this.getRoot(),a={},null!=i._authoritative&&(a.a=i._authoritative),null!=i.data&&(a.d=i.data),null!=(r=i.getExpiration())&&(a.n=r.getTime()),h=i._children;for(u in h)if(t.call(h,u)){o=h[u];for(s in o)t.call(o,s)&&(n=o[s],null==a.c&&(a.c={}),null==(l=a.c)[u]&&(l[u]={}),a.c[u][s]=n.toJSON(!0))}return a},s.prototype.valueOf=function(){return JSON.stringify(this.toJSON(i))},s.prototype.toString=s.valueOf,s.prototype.expired=function(){var t;return t=this.getExpiration(),null!=t&&new Date>=t?!0:!1},s.prototype.setExpiration=function(t){var e;return e=new Date,null!=t&&e.setTime(t-s.cacheTime),this._time=e},s.prototype.getExpiration=function(){var t;if(null!=this._time)return t=new Date,t.setTime(this._time.getTime()+s.cacheTime),t},s.prototype.isAuthoritativeFor=function(t){var e;return e=r.factory(t),null==e||null==this.url()?!1:this.url().equals(e,!1)?!0:this.isSet()&&e.isCacheChildOf(this.url(),!1)?this._authoritative:!1},s}()})}.call(this),function(){var t,e={}.hasOwnProperty;t="cache",n("zvelonet/lib/cache",["./lodash","./log","./storage","./url","./urlnode"],function(t,n,r,i,s){var o;return o=function(){function o(t){this._ns=t,this._root={},this._index="Cache",this.loaded=!1}return o.prototype._forEachMapping=function(t){var n,r,i;this.loadFromStorage(),r=this._root,i=[];for(n in r)if(e.call(r,n)){if(t.call(this,n)===!1)break;i.push(void 0)}return i},o.prototype.getRoot=function(t){var e;if(null!=t)return this.loadFromStorage(),null!=(e=this._root)?e[t]:void 0},o.prototype.clear=function(t,e){var r,s,o,a,u;if(o=this.getRoot(t),a=this.size(),null!=o&&null!=e){if(u=i.factory(e),null==u)return n("not clearing from invalid url "+e),0;s=o.get(u,!0),s&&(n("clearing urls from "+u+" in mapping "+t),s.rm(),o.prune())}else n("clearing all url cache entries"),this._root={};return r=a-this.size(),r>0&&this.write(),r},o.prototype.expire=function(t){var e;return e=!1,this._forEachMapping(function(t){return this._root[t].expire()?e=!0:n("nothing to expire for "+t)}),!t&&e&&this.write(),e},o.prototype.prune=function(){var t;return t=!1,this._forEachMapping(function(e){return this._root[e].prune()?t=!0:void 0}),t&&this.write(),t},o.prototype.write=function(){return r.write(this._index,this.toJSON(!0),this._ns)},o.prototype.toJSON=function(t){var e;return e={},this.expire(t),this._forEachMapping(function(t){return e[t]=this._root[t].toJSON()}),e},o.prototype.loadFromStorage=function(){return this.loaded?void 0:this.loadData(r.read(this._index,{},this._ns))},o.prototype.loadData=function(t){var n;this.loaded=!0,this._root={};for(n in t)e.call(t,n)&&(this._root[n]=new s(t[n]));return this.expire()},o.prototype.get=function(e,r,i){var s,o,a,u,l,h,c,p;if(u=this.getRoot(e),null!=u){if(!Array.isArray(r))return u.get(r,i);if(r.length){if(h=t.uniq(r),1===t.size(h))return this.get(e,h[0],i);for(a={hit:{},miss:[],bulk:!0},c=0,p=h.length;p>c;c++)l=h[c],s=this.get(e,l,i),(null!=s?s.isSet():void 0)?a.hit[l]=s:a.miss.push(l);return t.isEmpty(a.hit)?n("bulk cache miss 0/"+h.length):(o=t.size(a.hit),n(o===h.length?"bulk cache hit "+o+"/"+h.length:"bulk cache partial hit "+o+"/"+h.length),a)}}},o.prototype.size=function(t){var e,n;return null!=t?(n=this.getRoot(t),null==n?0:n.size()):(e=0,this._forEachMapping(function(t){return e+=this._root[t].size()}),e)},o.prototype.set=function(t,e,n,r){return this.getRoot(t)||(this._root[t]=new s),this.getRoot(t).set(e,n,r)},o.prototype.getMappings=function(){var t;return t=[],this._forEachMapping(function(e){return t.push(e)}),t},o.prototype.setExpiration=function(t,e){var r,s;if(null!=t&&(s=i.factory(t),null!=s))return r=!1,this._forEachMapping(function(t){var n,i;return i=this.getRoot(t),null!=i&&(n=i.get(s))?(n.setExpiration(e),r=!0):void 0}),r&&(n("writing after change in expiration"),this.write()),r},o}()})}.call(this),function(){var t,e,r={}.hasOwnProperty;t=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],e=function(){var e,n,r;for(e=r=0;3>=r;e=++r)try{return e?(n=t[e-1],new ActiveXObject(""+n+".XMLHTTP")):new XMLHttpRequest}catch(i){}},n("zvelonet/lib/ajax",["when"],function(t){var n;return n=function(){function n(e){var n,r;if(null!=e)switch(typeof e){case"string":this.url=e;break;case"object":this.url=e.url,this.data=e.data,this.dataType=e.dataType,this.async=e.async,this.timeout=e.timeout,this.method=e.method,this.cache=e.cache}try{if(null==this.url)throw new Error("url is required");this._setDefaults(),this._validateDataType(),n=t.defer(),this._resolver=n.resolver,this.ready=n.promise,this._prep(),"jsonp"===this.dataType?this._execJsonp():this._execXhr()}catch(i){r=i,this._error("Caught: "+r.message)}}return n.prototype._setDefaults=function(){return"string"==typeof this.method&&(this.method=this.method.toUpperCase()),null==this.method&&(this.method="GET"),null==this.async&&(this.async=!0),null==this.dataType&&(this.dataType="json"),null==this.timeout&&(this.timeout=0),null!=this.cache?this.cache:this.cache=!0},n.prototype._validateDataType=function(){if("text"!==this.dataType&&"json"!==this.dataType&&"jsonp"!==this.dataType)throw new Error("invalid dataType: "+this.dataType)},n.prototype._validateMethod=function(){if("GET"!==this.method)throw new Error("TODO(jrubin) method is not yet implemented: "+this.method)},n.prototype._appendQuery=function(t){return this._queryUrl=(""+this._queryUrl+"&"+t).replace(/[&?]{1,2}/,"?")},n.prototype._prep=function(){var t;return this._queryUrl=this.url,this.cache||this._appendQuery("_="+Date.now()),null!=this.data?(t=n.serialize(this.data).join("&"),"GET"===this.method?this._appendQuery(t):this._queryData=t):void 0},n.serialize=function(t,e,i){var s,o,a;null==e&&(e=[],e.add=function(t,e){return this.push(""+encodeURIComponent(t)+"="+encodeURIComponent(e))}),s=Array.isArray(t);for(o in t)if(r.call(t,o))switch(a=t[o],null!=i&&(o=""+i+"["+(s?"":o)+"]"),typeof a){case"array":case"object":n.serialize(a,e,o);break;default:e.add(o,a)}return e},n.prototype._error=function(t){return this._resolver.reject("Ajax: "+t)},n.prototype._success=function(t){var e,n;switch(this.dataType){case"text":case"jsonp":e=t;break;case"json":try{e=JSON.parse(t)}catch(r){return n=r,void this._error("JSON parse error: "+n.message,t)}break;default:throw new Error("unexpected dataType: "+this.dataType)}return this._resolver.resolve(e)},n.prototype._execJsonp=function(){var t,e,n,r,i,s,o,a;if("undefined"==typeof window||null===window||"undefined"==typeof document||null===document)throw new Error("JSONP is not supported on your platform");return o=Math.round(1000001*Math.random()),n="jsonp"+o,this._appendQuery("callback="+n),a=document.createElement("script"),a.setAttribute("src",this._queryUrl),s=document.getElementsByTagName("head")[0],i=function(){clearTimeout(e);try{s.removeChild(a)}catch(t){}window[n]=void 0;try{return delete window[n]}catch(t){}},t=function(t){return null==t&&(t="abort"),i(),"timeout"===t&&(window[n]=function(){}),this._error(t)},r=function(t){return i(),this._success(t)},window[n]=r.bind(this),a.onerror=t.bind(this,"error"),s.appendChild(a),this.timeout>0?e=setTimeout(t.bind(this,"timeout"),this.timeout):void 0},n.prototype._execXhr=function(){var t,n,i,s,o,a,u;if(u=e(),t=function(){return u.onreadystatechange=function(){},u.abort(),this._error("timeout")},this.timeout>0&&(n=setTimeout(t.bind(this),this.timeout)),null==u)throw new Error("could not create xhr");u.open(this.method,this._queryUrl,this.async),i={"X-Requested-With":"XMLHttpRequest"},"GET"!==this.method&&(i["Content-Type"]="application/x-www-form-urlencoded"),i.Accept=function(){switch(this.dataType){case"text":return"text/plain";case"json":return"application/json";default:throw new Error("unexpected dataType: "+this.dataType)}}.call(this);for(s in i)r.call(i,s)&&(a=i[s],u.setRequestHeader(s,a));if(o=function(){return 4===u.readyState?(u.onreadystatechange=function(){},clearTimeout(n),200===u.status?this._success(u.responseText):this._error("status: "+u.status,u)):void 0},!this.async)throw new Error("TODO(jrubin) sync is not yet implemented");return u.onreadystatechange=o.bind(this),u.send(this._queryData)},n}(),function(t){return new n(t).ready}})}.call(this),function(){var t,e,r;r=864e5,t=r,e="https://dl.zvelo.com",n("zvelonet/lib/dlfile",["when","./log","./ajax","./url"],function(n,r,i,s){var o;return o=function(){function o(e,r){var i,s,o,a,u;this.filename=e,this._zn=r,s=n.defer(),this._resolver=s.resolver,this.ready=s.promise;try{if(!(null!=(a=this.filename)?a.length:void 0))throw new Error("filename is required");this._index="DLFile."+this.filename,this._expireDuration=null!=(u=this._zn.fileExpireDuration)?u:t,this._genUrl(),this._genData(),i=this._read(),null!=i&&(this.value=i.value,this.storedAt=i.storedAt),this.expired()?this._fetch():this._resolve()}catch(l){o=l,this._reject("Caught: "+o.message)}}return o.prototype._genFormat=function(){return this.dataType=this._zn.forceXHR?"json":"jsonp"},o.prototype._genUrl=function(){var t,n;if(t=s.hostUrl(null!=(n=this._zn.dlhost)?n:e),null==t)throw new Error("invalid dlhost: "+this._zn.dlhost);return this.url=""+t+this.filename},o.prototype._genData=function(){var t,e;if(!((null!=(t=this._zn.username)?t.length:void 0)&&(null!=(e=this._zn.password)?e.length:void 0)))throw new Error("username and password are required");return null==this.data&&(this.data={}),this.data.format=this._genFormat(),this.data.username=this._zn.username,this.data.password=this._zn.password},o.prototype._read=function(){return this._zn._read(this._index)},o.prototype._write=function(t){return this._zn._write(this._index,t)},o.prototype._delete=function(){return this._zn._delete(this._index)},o.prototype.expired=function(){var t,e,n;return null==this.value||null==this.storedAt?!0:(e=Date.now()-this.storedAt,n=e>this._expireDuration,n?r(""+this.filename+" has expired, fetching another"):(t=Math.round((this._expireDuration-e)/1e3),r(""+this.filename+" expires in "+t+" seconds")),n)
},o.prototype._resolve=function(){return this._resolver.resolve(this)},o.prototype._reject=function(t){var e;return e="DLFile: Error fetching "+this.filename,null!=t&&(e+=": "+t),this._resolver.reject(e)},o.prototype._fetch=function(){return r("AJAX: fetching "+this.filename),i(this).then(this._store.bind(this)).otherwise(this._reject.bind(this))},o.prototype._store=function(t,e,n){return(null!=t?t.success:void 0)?(this.value=t[this.filename],this.storedAt=Date.now(),this._write({value:this.value,storedAt:this.storedAt}),this._resolve()):this._reject(n)},o.prototype["delete"]=function(){return delete this.value,delete this.storedAt,this._delete()},o}()})}.call(this),function(){n("hashmash/lib/sha1",[],function(){var t,e,n,r,i,s,o;return t=function(t,e){return t<<e|t>>>32-e},r=function(t){var e,n,r,i;for(n="",e=i=7;i>=0;e=--i)r=t>>>4*e&15,n+=r.toString(16);return n},e=function(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}},s=function(n){var i,s,o,a,u,l,h,c,p,f,d,g,y,m,v,_,b,w,k,x,S,E,C,T,P,N,A,O,j;for(l=[1518500249,1859775393,2400959708,3395469782],n+=String.fromCharCode(128),k=n.length/4+2,c=Math.ceil(k/16),h=[],b=E=0,O=c-1;O>=0?O>=E:E>=O;b=O>=0?++E:--E)for(h[b]=[],w=C=0;15>=C;w=++C)h[b][w]=n.charCodeAt(64*b+4*w+0)<<24|n.charCodeAt(64*b+4*w+1)<<16|n.charCodeAt(64*b+4*w+2)<<8|n.charCodeAt(64*b+4*w+3)<<0;for(f=4294967296,h[c-1][14]=8*(n.length-1)/f,h[c-1][14]=Math.floor(h[c-1][14]),h[c-1][15]=8*(n.length-1)&4294967295,i=1732584193,s=4023233417,o=2562383102,a=271733878,u=3285377520,d=[],b=T=0,j=c-1;j>=0?j>=T:T>=j;b=j>=0?++T:--T){for(S=P=0;15>=P;S=++P)d[S]=h[b][S];for(S=N=16;79>=N;S=++N)d[S]=t(d[S-3]^d[S-8]^d[S-14]^d[S-16],1);for(g=i,y=s,m=o,v=a,_=u,S=A=0;79>=A;S=++A)x=Math.floor(S/20),p=t(g,5)+e(x,y,m,v)+_+l[x]+d[S]&4294967295,_=v,v=m,m=t(y,30),y=g,g=p;i=i+g&4294967295,s=s+y&4294967295,o=o+m&4294967295,a=a+v&4294967295,u=u+_&4294967295}return r(i)+r(s)+r(o)+r(a)+r(u)},i=function(t){var e,n,r,i,s;for(n=0,r=i=0,s=t.length-1;(s>=0?s>=i:i>=s)&&(e=parseInt(t[r],16),!isNaN(e));r=s>=0?++i:--i){switch(!1){case 0!==e:n+=4;break;case 1!==e:n+=3;break;case!(e>=2&&3>=e):n+=2;break;case!(e>=4&&7>=e):n+=1}if(0!==e)break}return n},o=function(t){var e,n;return e=""+t.challenge+":"+t.counter,n=s(e),i(n)>=t.bits?(t.result=e,!0):(t.counter+=1,!1)},n=function(t){return s(t)},n.leading0s=function(t){return i(t)},n.tryChallenge=function(t){return o(t)},n})}.call(this),function(){n("hashmash/lib/hashmash",["when","./sha1"],function(t,e){var n,r,i;return r=function(t){return"string"==typeof t?6!==t.length?null:t:"number"!=typeof t?null:r(""+t)},i=function(t,e){return e.start=e.end+1,e.start===t.length?!1:(e.end=t.indexOf(":",e.start),-1===e.end?!1:e.end===e.start?!1:!0)},n=function(){function n(t,e,r){var i,s;this._bits=t,this._bits<n.MIN_BITS&&(this._bits=n.MIN_BITS),this._workers=[],this._range={},this._resetRange(),i=n.TaskMaster,null==e&&null!=n.BackupTaskMaster&&(i=n.BackupTaskMaster),r=null!=r?Math.min(r,i.MAX_NUM_WORKERS):i.DEFAULT_NUM_WORKERS,r&&(this._workers=function(){var t,n;for(n=[],s=t=1;r>=1?r>=t:t>=r;s=r>=1?++t:--t)n.push(new i(this._range,e));return n}.call(this))}return n.VERSION=1,n.MIN_BITS=16,n.hash=e,n.date=function(){var t,e,n,r;return n=new Date,r=("0"+(n.getYear()-100)).slice(-2),e=("0"+(n.getMonth()+1)).slice(-2),t=("0"+n.getDate()).slice(-2),""+r+e+t},n.parse=function(t){var e,n,r;return null==t?null:(n={},r={start:0,end:-1,length:function(){return this.end-this.start}},i(t,r)?(n.version=parseInt(t.substr(r.start,r.length()),10),isNaN(n.version)?null:i(t,r)?(n.bits=parseInt(t.substr(r.start,r.length()),10),isNaN(n.bits)?null:i(t,r)?(n.date=parseInt(t.substr(r.start,r.length()),10),isNaN(n.date)?null:i(t,r)?(n.resource=t.substr(r.start,r.length()),n.resource.length&&i(t,r)?(n.rand=t.substr(r.start,r.length()),n.rand.length?(i(t,r),e=(-1===r.end?t.length:r.end)-r.start,n.counter=parseInt(t.substr(r.start,e),10),isNaN(n.counter)?null:n):null):null):null):null):null):null)},n.unparse=function(t){var e,n;return n="",null==t.version?n:(n+=""+t.version+":",null==t.bits?n:(n+=""+t.bits+":",null==t.date?n:(e=r(t.date),null==e?n:(n+=""+e+":",null==t.resource?n:(n+=""+t.resource+":",null==t.rand?n:(n+=t.rand,null==t.counter?n:n+=":"+t.counter))))))},n.prototype._resetRange=function(){return this._range={begin:0,end:-1}},n.prototype._sendData=function(t,e){var n,r,i,s,o;for(s=this._workers,o=[],r=0,i=s.length;i>r;r++)n=s[r],o.push(n.sendData(t,e));return o},n.prototype.stop=function(){var t,e,n,r,i;for(r=this._workers,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.stop());return i},n.prototype.generate=function(e){var r,i,s,o,a,u;this._resetRange(),u=t.defer(),a=u.resolver,o=u.promise,s={version:n.VERSION,bits:this._bits,date:n.date(),resource:e,rand:Math.random().toString(36).substr(2)},r={challenge:n.unparse(s),counter:0,bits:s.bits};try{this._sendData(a,r)}catch(l){i=l,a.reject(i)}return o.ensure(this.stop.bind(this)),o},n.prototype.validate=function(t){var r,i;if(null!=t&&"string"==typeof t&&null!=this._bits&&(r=n.parse(t),null!=r&&!(r.bits<this._bits||r.bits<n.MIN_BITS||r.version!==n.VERSION||(i=n.date(),r.date<i-1||r.date>i+1||!(e.leading0s(n.hash(t))>=r.bits)))))return r},n}()})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};n("hashmash/lib/taskmaster",["./sha1"],function(t){var n,r,i,s,o,a;return n=99,r=1,a={},i=function(){function t(t){this._range=t,this._sendQueue=[],this._ready=!1}return t.RANGE_INCREMENT=Math.pow(2,15),t.prototype._send=function(t){return this._spawn(),null!=this.sendFn?this._ready?this.sendFn(t):this._sendQueue.push(t):void 0},t.prototype._setGo=function(){var t;for(this._ready=!0,t=[];this._sendQueue.length;)t.push(this._send(this._sendQueue.shift()));return t},t.prototype._spawn=function(){return null==this.worker?this.connect():void 0},t.prototype._incRange=function(){return this._range.begin=this._range.end+1,this._range.end=this._range.begin+t.RANGE_INCREMENT-1},t.prototype._sendRange=function(){return this._incRange(),this._send({m:"range",range:this._range})},t.prototype._gotResult=function(t){if(null==t)throw new Error("TaskMaster expected a result");if(null==this._resolver)throw new Error("TaskMaster requires a resolver");return this._resolver.resolve(t)},t.prototype._gotMessage=function(t){if(null!=(null!=t?t.m:void 0))switch(t.m){case"ready":return this._setGo();case"request_range":return this._sendRange();case"result":return this._gotResult(t.result)}},t.prototype.sendData=function(t,e){if(this._resolver=t,null==this._resolver)throw new Error("TaskMaster requires a resolver");return this._send({m:"data",data:e})},t.prototype.stop=function(){return this._ready=!1,this._sendQueue.length=0,null!=this.worker?(this.disconnect(),delete this.worker,delete this.sendFn):void 0},t}(),a.TaskMaster=i,o=function(t){function n(t,e){this.file=e,n.__super__.constructor.call(this,t)}return e(n,t),n.MAX_NUM_WORKERS=8,n.DEFAULT_NUM_WORKERS=4,n.prototype.connect=function(){var t;return this.worker=new Worker(this.file),t=this,this.worker.onmessage=function(e){return t._gotMessage(e.data)},this.worker.onerror=function(t){throw t.data},this.sendFn=function(t){return this.worker.postMessage(t)}},n.prototype.disconnect=function(){return this.worker.terminate()},n}(i),a.WebTaskMaster=o,s=function(){function e(){}return e.MAX_NUM_WORKERS=1,e.DEFAULT_NUM_WORKERS=1,e.prototype.sendData=function(t,e){if(this._resolver=t,this._data=e,null==this._resolver)throw new Error("TaskMaster requires a resolver");return delete this._stopFlag,this.start()},e.prototype.start=function(){var e,i;for(i=new Date;!(null!=this._stopFlag||null!=this._data.result||new Date-i>=n);)t.tryChallenge(this._data);if(null==this._stopFlag){if(null!=this._data.result){if(null==this._resolver)throw new Error("TaskMaster requires a resolver");return this._resolver.resolve(this._data.result)}return e=this,setTimeout(function(){return e.start()},r)}},e.prototype.stop=function(){return this._stopFlag=!0},e}(),a.TimeoutTaskMaster=s,a})}.call(this),function(){n("hashmash/hashmash",["./lib/hashmash","./lib/taskmaster"],function(t,e){var n=e.WebTaskMaster,r=e.TimeoutTaskMaster;return window.Worker?(t.TaskMaster=n,t.BackupTaskMaster=r):t.TaskMaster=r,t})}(),n("hashmash",["hashmash/hashmash"],function(t){return t}),function(){var t={}.hasOwnProperty;n("zvelonet/lib/cacheurl",["./lodash","./url"],function(e,n){var r;return r=function(){function r(t){if(this._cache=t,null==this._cache)throw new Error("Invalid cache object")}return r.prototype._rebuildCacheResult=function(t,n,r,i){var s,o,a,u,l;if(null!=r){if(null!=r.bulk)return this._rebuildBulkCacheResult(t,r,i);if(null!=(null!=(a=r.data)?a.c:void 0))return s=r.url().url,o={c:e.clone(r.data.c),m:t,u:n,b:r.data.b,fromCache:!0},(null!=i&&null!=(u=i.data)&&null!=(l=u.c)?l.length:void 0)&&(o.r=i.data.c[0]),o}},r.prototype._rebuildBulkCacheResult=function(n,r,i){var s,o,a,u,l,h;u={k:!0,m:n,hit:[],miss:r.miss},h=r.hit;for(l in h)t.call(h,l)&&(a=h[l],null==i||(o=e.find(i.hit,function(t,e){return l===e}),null!=o)?(s=this._rebuildCacheResult(n,l,a,o),null==s&&u.repMiss.push(l),delete s.m,u.hit.push(s)):u.repMiss.push(l));return u},r.prototype._parseCacheBase=function(t){var e,r,i,s;return r=t.b,e=!0,"."===(null!=r?r[0]:void 0)&&(e=!1,r=r.slice(1)),s=n.factory(r),i=n.factory(t.u),{url:s,authoritative:e,queried:i,cacheQueriedUrl:!e&&!s.equals(i)}},r.prototype._saveOne=function(t){var n,r,i,s;return r=t.m,(null!=t&&null!=(s=t.c)?s.length:void 0)?(n=this._parseCacheBase(t),i=this._cache.set(r,n.url,{c:e.clone(t.c),b:t.b},n.authoritative),n.cacheQueriedUrl&&this._cache.set(r,n.queried,{c:e.clone(t.c),b:t.b},!1),null!=t.r&&(t=e.clone(t),t.m="reputation",t.c=[t.r],delete t.r,this._saveOne(t)),i):!1},r.prototype.save=function(t){var n,r,i,s,o,a,u;if(null!=t.k){for(s=!1,n=t.m,u=t.k,o=0,a=u.length;a>o;o++)r=u[o],r.fromCache||(s=!0,i=e.clone(r),i.m=n,this._saveOne(i));if(s)return this._cache.write()}else if(!t.fromCache){if(t.fromCache)return;return this._saveOne(t),this._cache.write()}},r.prototype.lookup=function(t,e){var n,r;return r=this._cache.get(e.m,t),null==r||e.r&&(n=this._cache.get("reputation",t),null==n)?void 0:this._rebuildCacheResult(e.m,t,r,n)},r}()})}.call(this),function(){var t,e={}.hasOwnProperty;t=function(t,e,n){return t[n]=t[e],delete t[e]},n("zvelonet/lib/znajax",["when","hashmash","./lodash","./ajax","./url","./cacheurl"],function(n,r,i,s,o,a){var u;return u=function(){function u(t,e,n){var r;this.zn=e,this._cache=n;try{this._setup(),this.configure(t),this.execute()}catch(i){r=i,this.reject(r.message)}}return u.pending={},u.prototype._setup=function(){var t;return t=n.defer(),this._resolver=t.resolver,this.complete=t.promise},u.prototype.configure=function(t){switch(typeof t){case"string":this._url=t;break;case"object":this.url=t.url,this.onHashMash=t.onHashMash,this.onAjax=t.onAjax,this.mapping=t.mapping,this.reputation=t.reputation,this.categoryIds=t.categoryIds,this.sync=t.sync,null!=this.url&&(this._url=this.url,delete this.url)}if(null!=this.zn.timeout&&(this.timeout=this.zn.timeout),"string"==typeof this._url){if(!this._url.length||!o.factory(this._url))throw new Error("invalid url: "+this._url)}else{if(!Array.isArray(this._url))throw new Error("invalid url: "+this._url);if(!this._url.length)throw new Error("invalid url: "+this._url);this._url=i.uniq(this._url),1===this._url.length&&(this._url=this._url[0])}return null!=this.data?this.data:this.data={}},u.prototype._checkCache=function(){var t;return this._cache&&null!=this.zn.cache?(this._cacheUrl=new a(this.zn.cache),t=this._cacheUrl.lookup(this._url,this.data),null==t?!1:Array.isArray(this._url)?t.miss.length?(t.hit.length&&(this._cacheHit=t.hit),this._url=t.miss,!1):(this._done({k:t.hit,m:this.data.m,s:!0}),!0):(this._done(t),!0)):!1},u.checkPending=function(t){var e;if("string"==typeof t._url)return e=u.pending[t._url],(null!=e?e.m:void 0)===t.mapping&&(null!=e?e.r:void 0)===t.reputation&&i.isEqual(null!=e?e.c:void 0,t.categoryIds)?e.p:void(null==e&&(u.pending[t._url]={m:t.mapping,r:t.reputation,c:t.categoryIds,p:t.complete},t.complete.ensure(function(){return delete u.pending[t._url]})))},u.prototype.execute=function(){var t,e,n;if(!this._checkCache()){if(n=u.checkPending(this),null!=n)return this.complete=n;try{if(null!=this.zn.serial){if(!this.zn["dia.key"])throw new Error("missing dia.key");return this._ready()}if(Array.isArray(this._url))throw new Error("bulk lookup not allowed for hashmash");return null!=this.onHashMash&&this.onHashMash(),e=new r(this.zn.hashMashBits,this.zn.hashMashWorker),e.generate(encodeURIComponent(this._url)).then(this._ready.bind(this)).otherwise(this.reject.bind(this))}catch(i){return t=i,this.reject(t.message)}}},u.prototype._ready=function(t){if(this._genUrl(),this._genFormat(),null!=this.zn.serial)this.data.u=this._url;else{if(null==t)throw new Error("Unknown error");this.data.h=t}return this.zn.ready.then(this._doAjax.bind(this)).otherwise(this.reject.bind(this))},u.prototype._genFormat=function(){return this.dataType=this.zn.forceXHR?"json":"jsonp"},u.prototype._genUrl=function(){var t;if(t=o.hostUrl(this.zn.znhost),null==t)throw new Error("Invalid zveloNET host: "+this.zn.znhost);return this.url=""+t+this.ZN_PATH,null!=this.zn.serial?this.url+="/"+this.zn["dia.key"]+"/"+this.zn.serial:void 0},u.prototype._doAjax=function(){return null!=this.onAjax&&this.onAjax(),s(this).then(this._done.bind(this)).otherwise(this.reject.bind(this))},u.RENAMES={k:"bulk",u:"url",c:"categories",b:"cacheBase",m:"mapping",r:"reputationId"},u.rename=function(n){var r,i,s,o;s=u.RENAMES,o=[];for(r in s)e.call(s,r)&&(i=s[r],null!=n[r]&&o.push(t(n,r,i)));return o},u.decodeCategoryIds=function(t,e){var n,r,i,s,o,a,l,h,c,p,f,d;if(null==e)return t;if(null!=t.k){for(n=[],c=t.k,o=0,l=c.length;l>o;o++)r=c[o],n.push(u.decodeCategoryIds(r,e));return t.k=n,t}if(null!=t.c){for(s={},p=t.c,a=0,h=p.length;h>a;a++)i=p[a],s[i]=null!=(f=e[i])?f.name:void 0;t.c=s}return null!=t.r&&(t.reputation=null!=(d=e[t.r])?d.name:void 0),t},u.prototype._done=function(t,e,n){var r,s,o,a,l;if(!((null!=t?t.s:void 0)||(null!=t?t.fromCache:void 0)))return this.reject(n,e,t.m);if(delete t.s,null!=this._cacheUrl&&this._cacheUrl.save(t),null!=this._cacheHit&&(null!=t.k?t.k=i.union(this._cacheHit,t.k):(r=t.m,delete t.m,this._cacheHit.push(t),t={k:this._cacheHit,m:r})),u.decodeCategoryIds(t,this.zn["categories.txt"]),null!=t.k)for(l=t.k,o=0,a=l.length;a>o;o++)s=l[o],u.rename(s);return u.rename(t),this.resolve(t)},u.prototype.resolve=function(t){return this._resolver.resolve(t,this)},u.prototype.reject=function(t,e,n){var r,i;return null!=(null!=t?t.status:void 0)&&(r=t.status),i='Error with url: "'+this._url+'"',null!=n&&(i+=": "+n),null!=r&&(i+=" (code: "+r+")"),null!=t&&(i+=", "+t),this._resolver.reject(i,r)},u}()})}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,n){function r(){this.constructor=t}for(var i in n)e.call(n,i)&&(t[i]=n[i]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};t=!0,n("zvelonet/lib/lookup",["./znajax"],function(e){var n;return n=function(e){function n(e,r){n.__super__.constructor.call(this,e,r,t)}return r(n,e),n.prototype.ZN_PATH="l",n.prototype._validateMapping=function(){var t;if(null==this.mapping&&(this.mapping=this.zn.defaultMapping),-1===(null!=(t=this.zn)?t.mappings.indexOf(this.mapping):void 0))throw new Error("Invalid mapping: "+this.mapping);return this.mapping},n.prototype.configure=function(t){return n.__super__.configure.call(this,t),this.data.m=this._validateMapping(),this.reputation?this.data.r=!0:void 0},n}(e)})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};n("zvelonet/lib/report",["./znajax"],function(t){var n;return n=function(t){function n(t,e){n.__super__.constructor.call(this,t,e)}return e(n,t),n.prototype.ZN_PATH="r",n.prototype.configure=function(t){if(n.__super__.configure.call(this,t),"string"!=typeof this._url)throw new Error("invalid url: "+this._url);if(!Array.isArray(this.categoryIds)||!this.categoryIds.length)throw new Error("invalid category ids => "+this.categoryIds);return this.data.c=this.categoryIds},n}(t)})}.call(this),function(){var t={}.hasOwnProperty;n("zvelonet/lib/zvelonet",["when","./semver","./log","./storage","./cache","./url","./dlfile","./lookup","./report"],function(e,n,r,i,s,o,a,u,l){var h;return h=function(){function o(t){var e;try{this._setup(),this._configure(t),this._init()}catch(n){e=n,this._reject(e.message)}}return o.VERSION="3.0.0",o.prototype._setup=function(){var t;return t=e.defer(),this._resolver=t.resolver,this.ready=t.promise},o.prototype._configure=function(t){return"object"==typeof t&&(this.namespace=t.namespace,this.znhost=t.znhost,this.dlhost=t.dlhost,this.fileExpireDuration=t.fileExpireDuration,this.defaultMapping=t.defaultMapping,this.timeout=t.timeout,this.forceXHR=t.forceXHR,this.useCache=t.useCache,this.sync=t.sync,this.hashMashBits=t.hashMashBits,this.hashMashWorker=t.hashMashWorker,this.username=t.username,this.password=t.password,this.serial=t.serial),null==this.dlhost&&delete this.dlhost,null==this.fileExpireDuration&&delete this.fileExpireDuration,null==this.namespace&&(this.namespace="zvelo.net"),null==this.znhost&&(this.znhost="https://query.zvelo.com"),null==this.defaultMapping&&(this.defaultMapping="zvelodb-v3"),null==this.timeout&&(this.timeout=5e3),null==this.forceXHR&&(this.forceXHR=!1),null==this.useCache&&(this.useCache=!0),null==this.sync&&(this.sync=!1),null==this.hashMashBits&&(this.hashMashBits=18),this.version=o.VERSION,this.useCache?this.cache=new s(this.namespace):delete this.cache},o.prototype._read=function(t,e){return i.read(t,e,this.namespace)},o.prototype._write=function(t,e){return i.write(t,e,this.namespace)},o.prototype._delete=function(t){return i["delete"](t,this.namespace)},o.prototype._init=function(){return this._updateVersion(),e.all(this._loadFiles()).then(this._resolve.bind(this)).otherwise(this._reject.bind(this))},o.prototype._resolve=function(){return r("zvelo.net ready"),this._resolver.resolve(this)},o.prototype._reject=function(t){return r("zvelo.net could not be initialized",t),this._resolver.reject()},o.prototype._updateVersion=function(){var t,e;if(t=this._read("VERSION"),null!=t)switch(e=n.compare(t,o.VERSION),!1){case 0!==e:return r("welcome back to zvelo.net! you haven't changed a bit!"),!1;case!(e>0):return r("You have been cheating on me with another zvelo.net!I don't know what to do with myself!"),!1;case!(0>e):r("welcome back to zvelo.net! It looks like we have some catching up to do...")}return this._write("VERSION",o.VERSION),this.clearCache(),r("now that you have been reacquainted with zvelo.net, lets get to work..."),!0},o.prototype._loadFile=function(t){var e;return null==this._files&&(this._files={}),e=new a(t,this),this._files[t]=e,e.ready.then(function(e){return this[t]=e.value}.bind(this)),e.ready},o.prototype._loadFiles=function(){var t;return t=[this._loadFile("mappings"),this._loadFile("categories.txt")],null!=this.serial&&t.push(this._loadFile("dia.key")),t},o.prototype.clearFiles=function(e){var n;return n=function(){var e,n,r;r=this._files;for(n in r)t.call(r,n)&&(e=r[n],e["delete"](),delete this._files[n],delete this[n]);return delete this._files},this.ready.ensure(n.bind(this)),null!=e&&e?void 0:this.reinit()},o.prototype.reinit=function(){var t;return t=this.ready,this._setup(),t.then(this._init.bind(this)),this.ready},o.prototype.clearCache=function(){var t;return null!=(t=this.cache)?t.clear():void 0},o.prototype.expireCache=function(){var t;return null!=(t=this.cache)?t.expire():void 0},o.prototype.lookup=function(t){return new u(t,this).complete},o.prototype.report=function(t){return new l(t,this).complete},o.categorySort=function(t){var e,n,r;n=[];for(e in t)r=t[e],n.push(r);return n.sort(function(t,e){return t.name===e.name?0:t.name<e.name?-1:1}),n},o.prototype.setSerial=function(t){return this.serial=t,this.reinit()},o}()})}.call(this),function(){n("zvelonet/zvelonet",["./lib/zvelonet"],function(t){return t})}(),n("zvelonet",["zvelonet/zvelonet"],function(t){return t}),function(){n("event",[],function(){var t;return t=function(){function t(){}return t.ONCE=!0,t.prototype.on=function(e,n,r){var i;if(null!=e&&null!=n)return null==this._events&&(this._events={}),null==(i=this._events)[e]&&(i[e]={all:[],once:[]}),r===t.ONCE?this._events[e].once.push(n):this._events[e].all.push(n),this},t.prototype.off=function(t,e){var n,r,i,s;if(null!=t&&null!=e&&null!=(null!=(s=this._events)?s[t]:void 0))return n=this._events[t].all,i=this._events[t].once,(r=null!=i?i.indexOf(e):void 0)>-1&&i.splice(r,1),(r=null!=n?n.indexOf(e):void 0)>-1&&n.splice(r,1),this},t.prototype.trigger=function(t){var e,n,r,i,s,o,a,u,l;if(null!=t&&null!=this._events&&null!=(null!=(a=this._events)?a[t]:void 0)){for(e=Array.prototype.slice.call(arguments,1),u=this._events[t].all,r=0,s=u.length;s>r;r++)n=u[r],n.apply(this,e);for(l=this._events[t].once,i=0,o=l.length;o>i;i++)n=l[i],n.apply(this,e);return this._events[t].once=[],this}},t}()})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};n("modal",["templates","event","element"],function(t,n,r){var i;return i=function(i){function s(e){this.ctx=e,this._configure(),this.el=r(t.modal(this.ctx)),this.el.animate(this.el.hasClass("fade")),this.on("backdrop shown",this._onBackdropShown.bind(this)),this.on("modal shown",this._onModalShown.bind(this)),this.on("modal hidden",this._onModalHidden.bind(this)),this.on("backdrop hidden",this._onBackdropHidden.bind(this))}return e(s,i),s.hideCurrent=function(t){return null==s.current&&"hidden"!==s.status?(null!=t&&t(),!1):(null!=t&&s.current.on("hidden",t,n.ONCE),s.current.hide(),!0)},s.prototype._configure=function(){return null!=this.ctx?this.ctx:this.ctx={}},s.prototype._showBackdrop=function(){return"showing"===this.status?(this.backdrop=r("<div>",this.el.animate()).addClass("modal-backdrop"),null!=this.ctx["class"]&&this.backdrop.addClass(this.ctx["class"]),this.el.animate()&&this.backdrop.addClass("fade"),r(document.body).append(this.backdrop),this.ctx.close&&this.backdrop.on("click",this.hide.bind(this)),this.backdrop.reflow().addClass("in",this.trigger.bind(this,"backdrop shown"))):void 0},s.prototype._hideBackdrop=function(){return"hiding"===this.status&&null!=this.backdrop?this.backdrop.removeClass("in",this.trigger.bind(this,"backdrop hidden")):void 0},s.prototype._setStatus=function(t){return"hiding"!==this.status||"showing"!==t&&"shown"!==t?(this.status=t,this.trigger(t),!0):!1},s.prototype.setHeader=function(t){return this.el.find("h3").html(t),this},s.prototype.setBody=function(t){return this.el.find("p").html(t),this},s.prototype.show=function(){var t;return"shown"===(t=this.status)||"showing"===t?this:this._setStatus("showing")?(s.hideCurrent(this._show.bind(this)),this):this},s.prototype._show=function(){var t;if(null==s.current)return s.current=this,t=this,this.ctx.close&&(this.onKeyUp=function(e){return 27===e.which?t.hide():void 0},r(document.body).on("keyup",this.onKeyUp)),r(document.body).append(this.el),this._showBackdrop()},s.prototype._onBackdropShown=function(){return"showing"===this.status?(this.el.display("block").reflow(),this.ctx.btn&&this.el.find(".btn.btn-primary").on("click",this.hide.bind(this)),this.ctx.close&&this.el.find(".close").on("click",this.hide.bind(this)),this.el.addClass("in",this.trigger.bind(this,"modal shown"))):void 0},s.prototype._onModalShown=function(){return setTimeout(this._setStatus.bind(this,"shown"),1)},s.prototype._onBackdropHidden=function(){return this._removeBackdrop(),setTimeout(this._setStatus.bind(this,"hidden"),1)},s.prototype._onModalHidden=function(){return r(document.body).remove(this.el.display("none")),this._hideBackdrop()},s.prototype.hide=function(){if("showing"===this.status)return this.on("shown",this.hide.bind(this),n.ONCE);if("shown"===this.status)return this._setStatus("hiding"),this.el.removeClass("in",this.trigger.bind(this,"modal hidden")),this},s.prototype._removeBackdrop=function(){var t;return t=r(document.body),null!=this.onKeyUp&&t.off("keyup",this.onKeyUp),null!=this.backdrop&&t.remove(this.backdrop),s.current===this&&delete s.current,delete this.backdrop,null!=this.ctx.onClose?this.ctx.onClose(this):void 0},s.prototype.toggle=function(){var t;return"shown"===(t=this.status)||"showing"===t?this.hide():this.show()},s}(n)})}.call(this),function(){n("test-a-site",["templates","domReady","zvelonet","modal","element"],function(t,e,n,r,i){var s;return new(s=function(){function s(t,r,i){this.baseSelector=t,this.bodyClass=r,this.modalClass=i,this.zn=new n({znhost:"https://query.zvelo.com:3333",username:"zvelo.com",password:"7j25jx7XVAe",hashMashWorker:"./js/vendor/hashmash/worker.min.js",useCache:!1}),e(this.onDomReady.bind(this))}return s.prototype.onDomReady=function(){return i(document.documentElement).removeClass("no-js").addClass("js"),i(document).on("keydown",this.onKeyDown.bind(this)),window.onpopstate=this.onPopState.bind(this),this.container=i(document).find(this.baseSelector).addClass(this.bodyClass),this.showLoadingModal(),this.zn.ready.then(this.znReady.bind(this)).then(this.route.bind(this)).otherwise(this.showErrorModal.bind(this))},s.prototype.onKeyDown=function(t){var e,n,i,s,o,a;if(null==r.current&&(s=this.container.find("input"),o=this.container.find("button"),null!=s.el&&null!=o.el&&document.activeElement!==s.el&&!(t.altGraphKey||t.metaKey||t.altKey||t.shiftKey||t.ctrlKey)&&(a=t.keyCode)!==(e=13)&&a!==(n=32)&&a!==(i=65)))return s.focus()},s.prototype.znReady=function(){var t;t=n.categorySort(this.zn["categories.txt"]),this.categories=t.filter(function(t){return 0===t.name.indexOf("Custom User Type ")?!1:!0})},s.prototype.onPopState=function(t){return this.route(t.state)},s.prototype.route=function(t){var e;switch(e=this.getPath(),e.page){case"":e.page="lookup";break;case"report":null==t&&(e.page="lookup")}return this.show(e.page,t,e)},s.prototype.show=function(e,n,r){var i,s,o,a;switch(null!=(s=this.loadingModal)&&s.hide(),this.data=n||{},null==(null!=(o=this.data)?o.url:void 0)&&null==r&&(this.data={}),this.data.page=e,this.container.html(t[e](this.data)),i=this.container.find(".btn.lookup").on("click",this.show.bind(this,"lookup")),e){case"lookup":return this.showLookup();case"report":return this.showReport();case"result":if(null!=(null!=(a=this.data)?a.url:void 0))return this.showResult(i);if(null!=r&&(this.show("lookup",i.el),null!=r.arg))return this.doLookup(r.arg)}},s.prototype.showResult=function(){return this.setPath("result",this.data.url),this.container.find(".btn.report").on("click",this.show.bind(this,"report",{url:this.data.url,categories:this.categories}))},s.prototype.showLookup=function(){return this.setPath("lookup"),this.container.find("form").on("submit",this.submitLookup.bind(this))},s.prototype.showReport=function(){return this.setPath("report"),this.container.find("form").on("submit",this.submitReport.bind(this))},s.prototype.showErrorModal=function(){var t,e,n,i,s;for(i=0,s=arguments.length;s>i;i++)t=arguments[i],"function"==typeof t?e=t:n=t;return"undefined"!=typeof console&&null!==console&&console.error(n,null!=n?n.stack:void 0),new r({"class":""+this.modalClass+" "+this.bodyClass,header:"Error!",btn:"Dismiss",body:n,onClose:e}).show()},s.prototype.showWarning=function(t,e){return new r({"class":""+this.modalClass+" "+this.bodyClass,header:"Warning",body:t,btn:"OK",close:!0,onClose:e}).show()},s.prototype.showLoadingModal=function(){return this.loadingModal=new r({"class":""+this.modalClass+" "+this.bodyClass,header:"Loading...",body:"Initializing zveloNET..."}).show()},s.prototype.onHashMash=function(){var t;return null==this.authModal&&(this.authModal=new r({"class":""+this.modalClass+" "+this.bodyClass+" authorizing",header:"Authorizing..."})),t='<img src="./img/spinner-calculating.gif"><br>\nVerifying user credentials...',this.authModal.setBody(t).show()},s.prototype.onAjax=function(){var t,e;if("shown"===(null!=(e=this.authModal)?e.status:void 0))return t='<img src="./img/spinner-sending.gif"><br>\nQuerying Server...',this.authModal.setBody(t)},s.prototype.doLookup=function(t){var e;return e=this.container.find("input"),null!=e.el?(e.value().length||e.value(t),this.submitLookup()):void 0},s.prototype.submitLookup=function(t){var e;return null!=(null!=t?t.preventDefault:void 0)?t.preventDefault():null!=t&&(t.returnValue=!1),e=this.container.find("input").value(),(null!=e?e.length:void 0)?(document.activeElement.blur(),this.zn.lookup({url:e,reputation:!0,onHashMash:this.onHashMash.bind(this),onAjax:this.onAjax.bind(this)}).then(this.onLookupResponse.bind(this)).otherwise(this.showErrorModal.bind(this,this.show.bind(this,"lookup")))):void 0},s.prototype.submitReport=function(t){var e,n,r,i;return null!=(null!=t?t.preventDefault:void 0)?t.preventDefault():null!=t&&(t.returnValue=!1),n=this.container.find("select"),e=parseInt(null!=(i=n.options(n.selectedIndex()))?i.value:void 0,10),isNaN(e)?this.showWarning("Please choose a category"):(r=this.container.find(".url").text(),document.activeElement.blur(),this.zn.report({url:r,categoryIds:[e],onHashMash:this.onHashMash.bind(this),onAjax:this.onAjax.bind(this)}).then(this.onReportResponse.bind(this)).otherwise(this.showErrorModal.bind(this)))},s.prototype.getPath=function(){var t,e,n,r;return n=location.hash.slice(1).split("/"),e=n.shift(),t=n.join("/"),r={page:e},(null!=t?t.length:void 0)&&(r.arg=t),r},s.prototype.setPath=function(t,e){var n,r,i;return n=this.getPath(),n.page!==t||n.arg!==e?(r=""+t,null!=e&&(r+="/"+e),null!=(null!=(i=window.history)?i.pushState:void 0)?history.pushState(this.data,document.title,""+location.pathname+"#"+r):location.hash="#"+r):void 0},s.prototype.onLookupResponse=function(t){return this.authModal.hide(),this.show("result",t)},s.prototype.onReportResponse=function(){return new r({"class":""+this.modalClass+" "+this.bodyClass,header:"Thank you",body:"We have received your request.",btn:"Close",close:!0,onClose:this.show.bind(this,"lookup")}).show()},s}())("#zvelonet","zvelonet-body","zvelonet-modal")})}.call(this),e(["test-a-site"])}();
//# sourceMappingURL=test-a-site.min.js.map